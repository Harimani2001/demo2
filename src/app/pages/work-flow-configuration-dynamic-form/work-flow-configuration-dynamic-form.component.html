<div class="row">
  <div class="col-sm-12">
    <form #workFlowConfig="ngForm" novalidate>
      <table id="add-table" class="table w-100">
        <tbody>
          <tr *ngIf="isEdited">
            <td colspan="2">
              <div class="row">
                <div class="col-sm-1">
                  <strong class="strong">Level<span class="asterisk required">*</span> :</strong>
                </div>
                <div class="col-sm-11">
                  <select #level="ngModel" name="level" class="form-control" id="levelId" required
                    [(ngModel)]="workFlowDto.workFlowLevelId">
                    <option selected disabled [value]="0">Choose your level</option>
                    <option *ngFor="let level of allLevelList" [value]="level.key">{{level.value}}</option>
                  </select>
                  <div class="messages text-danger"
                    *ngIf="(level.touched || submitted) && workFlowDto.workFlowLevelId=='0'">Please select the level
                  </div>
                </div>
              </div>
            </td>
          </tr>

          <tr *ngIf="!isEdited">
            <td colspan="2">
              <div class="row">
                <div class="col-sm-1">
                  <strong class="strong">Level<span class="asterisk required">*</span> :</strong>
                </div>
                <div class="col-sm-11">
                  <select #level="ngModel" name="level" class="form-control" id="levelId" required
                    [(ngModel)]="workFlowDto.workFlowLevelId">
                    <option selected disabled [value]="0">Choose your level</option>
                    <option *ngFor="let level of levelList" [value]="level.key">{{level.value}}</option>
                  </select>
                  <div class="messages text-danger" *ngIf="(level.touched || submitted) && workFlowDto.workFlowLevelId=='0'">Please select the level
                  </div>
                </div>
              </div>
            </td>
          </tr>

          <tr>
            <td>
              <div class="row">
                <div class="col-sm-2">
                  <strong class="strong">Roles<span class="asterisk required">*</span> :</strong>
                </div>
                <div class="col-sm-10">
                  <ng-select [ngClass]="'ng-select'" name="roleId" required #userRole="ngModel" [options]="roleList"
                    [multiple]="true" [(ngModel)]="roleIds" rounds="ngModel" (ngModelChange)="this.loadUser(roleIds);">
                  </ng-select>
                  <div class="messages text-danger" *ngIf="(userRole.touched || submitted)&& userRole?.errors?.required">Please select atleast one role
                  </div>
                </div>
              </div>
            </td>

            <td>
              <div class="row">
                <div class="col-sm-2">
                  <strong class="strong">Users<span class="asterisk required">*</span> :</strong>
                </div>
                <div class="col-sm-10">
                  <ng-select [ngClass]="'ng-select'" name="user" required #user="ngModel" [options]="userList"
                    [multiple]="true" [(ngModel)]="workFlowDto.users" rounds="ngModel"></ng-select>
                  <div class="messages text-danger" *ngIf="(user.touched || submitted) && user.errors?.required">Please select atleast one user</div>
                </div>
              </div>
            </td>
          </tr>
        </tbody>
      </table>

      <br>
      <div class="form-group row">
        <div class="col-sm-12" style="text-align: center;">
          <button *ngIf="workFlowDto.id==0" type="button" class="btn btn-sm btn-success waves-effect waves-light m-r-10"
            (click)="$event.preventDefault();saveData(workFlowConfig.valid);">Save</button>
          <button *ngIf="workFlowDto.id!=0" type="button" class="btn btn-sm btn-success waves-effect waves-light m-r-10"
            (click)="$event.preventDefault();saveData(workFlowConfig.valid);">Update</button>
          <button type="button" class="btn btn-sm btn-danger waves-effect waves-light m-r-10"
            (click)="$event.preventDefault();redirectToView()">Cancel</button>
        </div>
      </div>
    </form>
  </div>
</div>

<br>
<ngx-datatable #myTable class="data-table dt-chk" [rows]='masterWorkFLowConfigData | projectsetupFilter : filterQuery'
  [limit]="10" [columnMode]="'force'" [headerHeight]="50" [footerHeight]="50" [rowHeight]="'auto'">
  <ngx-datatable-column name="Sl No." [width]="50">
    <ng-template let-row="row" ngx-datatable-cell-template>
      <strong>{{row['$$index']+1}}</strong>
    </ng-template>
  </ngx-datatable-column>
  <ngx-datatable-column style="font-weight: bold;" name="Form Name">
    <ng-template let-row="row" let-expanded="expanded" ngx-datatable-cell-template>
      <strong
        style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">{{row['masterName']}}</strong>
    </ng-template>
  </ngx-datatable-column>
  <ngx-datatable-column name="Level Name">
    <ng-template let-row="row" ngx-datatable-cell-template>
      <strong
        style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">{{row['workFlowLevelName']}}</strong>
    </ng-template>
  </ngx-datatable-column>
  <ngx-datatable-column name="Action">
    <ng-template let-row="row" ngx-datatable-cell-template>
      <a href="javascript:;" routerLinkActive="active" (click)="editLevel(row);"
        class="m-r-15 crm-action-edit text-muted text-primary" placement="top" ngbTooltip="Edit">
        <i class="icofont icofont-edit edit"></i>
      </a>
    </ng-template>
  </ngx-datatable-column>
</ngx-datatable>

<div *ngIf="spinnerFlag" class="loading">Loading&#8230;</div>