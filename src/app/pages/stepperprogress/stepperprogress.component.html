<div class="col-sm " style="height: 110px;" *ngIf="leveList == null && !isIcon">
  <ul *ngIf="null!=this.publishedData && this.publishedData.publishedFlag && null!= this.getStatus && this.getStatus.length>0 "
    class="progress-indicator">
    <li class="completed">
      <span lacement="top" ngbTooltip="created" class="bubble"></span>
      {{this.publishedData.publishedFlag?'Published':'Unpublished'}}
      <br><small></small>
    </li>
    <li *ngFor="let data of this.getStatus;let i = index "
      class=" {{ data.lastEntry?' current  ':(data.status=='Accepted')?'completed':(data.status=='Rejected')?'rejected':(data.status=='Deactivated')?'deactivated':'pending' }}">
      <label>
        <ng-template #popoverStepper>
          <div *ngIf="data.createdUserName!=null"><b>Action By :</b>&nbsp; {{data.createdUserName}}</div>
          <div *ngIf="data.createdTime!=null"><b>Created Time :</b>&nbsp;{{data.createdTime}}</div>
          <div *ngIf="data.comments!=null"><b>Comments :</b> {{data.comments}}</div>
          <div *ngIf="data.status!=null"><b>Status :</b> {{data.status}}</div>
        </ng-template>
        <ng-template #noproperty>
          <div><b>Level Name:</b>&nbsp; {{data.levelName}}</div>
        </ng-template>
        <ng-template #showmoreusers>
          <b>Users for level:-<br> {{ data.levelName}} :</b>
          <ul class="list-group" *ngFor="let d of data.userArray">
            <li class="list-group-item">{{d}}</li>
          </ul>
        </ng-template>
        <span style="white-space: pre-line;" placement="top" container="body" triggers="mouseenter:mouseleave"
          [ngbPopover]="data.comments=='not applicable'?noproperty:data.allUserApproval?noproperty:popoverStepper"
          class="bubble">
        </span>
        <a class="icofont icofont-ui-user-group" placement="bottom" container="body" triggers="mouseenter:mouseleave"
          [ngbPopover]="showmoreusers"></a>

        <a *ngIf="data.allUserApproval" class="font-size-20px pointer"
          (click)="userApprovalList=data.userApprovalList;allUserApprovalModal.show();" placement="top"
          ngbTooltip="All Users Approval"><i class="icofont icofont-speech-comments"></i></a>
        <a *ngIf=" data.lastEntry && data.permission && data.description"> <i class="icofont icofont-info-square info"
            (click)="getDescription(data);"></i>
        </a>
        <a *ngIf="data.lastEntry && data.permission" style="color: blue;" class="font-size-20px"
          (click)="externalApprovalmodal.show();onClickExternalApproval(this.getStatus); this.flag=false"
          placement="top" ngbTooltip="External Approval"><i class="fa fa-arrow-circle-o-right"></i></a>
        {{data.permission?'':data.type}} <br>
        <span *ngIf="!data.permission && data.lastEntry" class="messages text-danger">You dont have permission to do
          this action!</span>
        <span *ngIf="data.userApprovalDone && data.permission" class="messages text-info">You have approved, Still
          {{data.userArray.length - data.userApprovalList.length}} more user
          <ng-container *ngIf="(data.userArray.length - data.userApprovalList.length)!=1">s</ng-container> need to approve
        </span>
      </label>
      <br>
      <label>
        <app-individual-workflow [data]="this.getStatus" [closeFlag]="flag"
          *ngIf="data.actionType===1 && data.permission && !data.userApprovalDone"></app-individual-workflow>
        <app-documentsign [stepperData]="this.getStatus" [closeFlag]="flag"
          *ngIf="data.actionType===2 && data.permission && !data.userApprovalDone"></app-documentsign>
        <span *ngIf="data.sla && data.permission"> SLA:{{data.sla}} days</span>
      </label>
    </li>
  </ul>
</div>

    <a *ngIf="leveList == null && isIcon && this.currentLeveldata && !this.workflowJobStatus" role="button"><img class="image-radius rounded-0 img-25 float-right"
      src="assets/icon/png-icons/export.png" alt="Forum" placement="bottom" ngbTooltip="External Approval"
      (click)="externalApprovalmodal.show();onClickExternalApproval(this.getStatus); this.flag=false"></a>

  <a  *ngIf="leveList == null && isIcon" role="button"><img class="image-radius rounded-0 img-25 m-r-20 float-right"
    src="assets/icon/png-icons/workflow-new.png" alt="Forum" placement="bottom" ngbTooltip="Workflow"
    (click)="loadStepperData(); modalLargeWorkFlowProjectSummary.show();"></a>

    <a *ngIf="leveList == null && isIcon && this.currentLeveldata && this.currentLeveldata.description" role="button"><img class="image-radius rounded-0 img-25  m-r-20 float-right"
      src="assets/icon/png-icons/info.png" alt="Forum" placement="bottom" ngbTooltip="Instructions"
      (click)="getDescription(this.currentLeveldata)"></a>

      <app-individual-workflow [data]="this.getStatus" [closeFlag]="flag" [isIcon]="this.isIcon"
      *ngIf="leveList == null && isIcon && this.currentLeveldata && currentLeveldata.actionType===1 && !this.workflowJobStatus"></app-individual-workflow>
    <app-documentsign [stepperData]="this.getStatus" [closeFlag]="flag" [isIcon]="this.isIcon"
      *ngIf="leveList == null && isIcon && this.currentLeveldata && currentLeveldata.actionType===2 && !this.workflowJobStatus"></app-documentsign>

<app-modal-basic #levelDescription [hideFooter]="true" [dialogClass]="'modal-lg padding'" [headerStyle]="true">
  <div class="app-modal-header">
    <h5 class="font-header" *ngIf="content"><strong>Instruction {{content.levelName}}</strong></h5>
    <button type="button" class="close basic-close" (click)="levelDescription.hide();flag=true">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="app-modal-body" style="max-height: 140px !important;overflow: auto;">
    <div class="col-sm-12">
      <p class="text-muted" *ngIf="content" style="width:-webkit-fill-available" [innerHtml]="content.description">
    </div>
  </div>
</app-modal-basic>

<app-modal-basic #allUserApprovalModal [dialogClass]="'modal-lg all-user-approval-comment'" [hideHeader]="false"
  [hideFooter]="false">
  <div class="app-modal-header">
    <h4 class="modal-title">All User Approval</h4>
    <button type="button" class="close basic-close" (click)="allUserApprovalModal.hide();">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="app-modal-body">
    <div class="row">
      <div class="col-sm-12" *ngIf="userApprovalList.length!=0">
        <table id="all-user-approval-table" class="table table-striped table-bordered w-100">
          <thead>
            <tr>
              <th class="w-10">Sr. No</th>
              <th class="w-20">Action By</th>
              <th class="w-20">Created Time</th>
              <th class="w-50">Comments</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let u of userApprovalList;let i=index">
              <td>{{i+1}}</td>
              <td>{{u.user}}</td>
              <td>{{u.dateTime}}</td>
              <td>
                <p class="fs-15 text-justify text-break">{{u.comments}}</p>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <div class="col-sm-12" *ngIf="userApprovalList.length==0">
        <label class="form-control-label">No comments</label>
      </div>
    </div>
  </div>
</app-modal-basic>

<app-modal-basic #externalApprovalmodal [dialogClass]="'modal-md'" [hideHeader]="false" [hideFooter]="false">
  <div class="app-modal-header">
    <h4 class="modal-title">External Approval</h4>
    <button type="button" class="close basic-close" (click)="externalApprovalmodal.hide(); this.flag=true">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="app-modal-body">
    <div class="row">
      <div class="col-sm-12">
        <form [formGroup]="onExternalApprovalForm">
          <div class="form-group row">
            <label class="col-sm-10 col-form-label">Name
              <span class="asterisk required">*</span>
            </label>
            <div class="col-sm-10">
              <input type="text" name="name" id="nameId" class="form-control" placeholder="name" formControlName="name"
                maxlength="50" />
              <div class="messages text-danger"
                *ngIf="onExternalApprovalForm.get('name').touched && onExternalApprovalForm.get('name').hasError('required')">
                {{externalApprovalErrorTypes.nameValidation}}</div>
            </div>
          </div>
          <div class="form-group row">
            <label class="col-sm-10 col-form-label">Email
              <span class="asterisk required">*</span>
            </label>
            <div class="col-sm-10">
              <input type="text" name="code" id="emailId" class="form-control" placeholder="email"
                formControlName="email" maxlength="50" />
              <div class="messages text-danger"
                *ngIf="onExternalApprovalForm.get('email').touched && onExternalApprovalForm.get('email').hasError('required')">
                {{externalApprovalErrorTypes.emailValidation}}</div>
              <div class="messages text-danger" *ngIf="onExternalApprovalForm.get('email').hasError('pattern')">
                {{externalApprovalErrorTypes.emailPatternValidation}}</div>
            </div>
          </div>
          <div class="form-group row">
            <label class="col-sm-10 col-form-label">Validity (Days)
              <span class="asterisk required">*</span>
            </label>
            <div class="col-sm-10">
              <input type="number" class="form-control" formControlName="validity" />
              <div class="messages text-danger"
                *ngIf="onExternalApprovalForm.get('validity').touched && onExternalApprovalForm.get('validity').hasError('required')">
                {{externalApprovalErrorTypes.validityValidation}}</div>
            </div>
          </div>
          <div class="form-group row">
            <label class="col-sm-10 col-form-label">Remarks
              <span class="asterisk required">*</span>
            </label>
            <div class="col-sm-10">
              <textarea rows="3" class="form-control" formControlName="remarks"></textarea>
              <div class="messages text-danger"
                *ngIf="onExternalApprovalForm.get('remarks').touched && onExternalApprovalForm.get('remarks').hasError('required')">
                {{externalApprovalErrorTypes.remarksValidation}}</div>
            </div>
          </div>
          <br>
          <div class="form-group row">
            <div class="col-sm-12 text-center">
              <button type="button" class="btn btn-sm btn-success waves-effect waves-light m-r-10"
                (click)="onClickSave(); this.flag=true">Submit for Approval</button>
              <button type="button" class="btn btn-sm btn-danger waves-effect waves-light m-r-10"
                (click)="externalApprovalmodal.hide(); this.flag=true">Cancel</button>
            </div>
          </div>
        </form>
      </div>
    </div>
    <div *ngIf="spinnerFlag" class="loading">Loading&#8230;</div>
  </div>
</app-modal-basic>

<div *ngIf="spinnerFlag" class="loading">Loading&#8230;</div>

<app-modal-basic #modalLargeWorkFlowProjectSummary [dialogClass]="'modal-lg'" [hideClickOutSide]="true"
  class="modal-dialog modal-dialog-scrollable">
  <div class="app-modal-header">
    <h4 class="modal-title strong">Workflow Configuration</h4>
    <button type="button" class="close basic-close" (click)="modalLargeWorkFlowProjectSummary.hide()">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div style="max-height: 400px !important;" class="app-modal-body">
    <div style="max-height: 300px !important;" class="col-sm slimScrollDiv">
      <div class="dt-desc dy-width-300">
          <ul class="progress-indicator">
            <li *ngFor="let data of this.getStatus;" class="completed">
              <label>
                <span style="white-space: pre-line;" class="bubble"></span>
                <div  style="text-align: left;" class="strong"><a role="button" *ngIf="data.workFlowCompleted"><img style="width: 25px; height: 25px;" class="image-radius rounded-0 img-30 m-r-10"
                  src="assets/icon/png-icons/checked.png" alt="Forum" placement="bottom" ngbTooltip="External Approval"></a> {{data.levelName}} : {{data.type}}<br>
                  <span *ngIf="data.allUserApproval">(All User Approval)</span><br>
                  <div><b class="black"><u>Users</u></b>
                    <div *ngIf="data.allUserApproval && data.userApprovalList.length > 0">
                      <li *ngFor="let user of data.userApprovalList;let i = index ">
                        {{i+1}}.{{user.user}}
                        <div *ngIf="user.comments" class="black"><b>Comments : </b> {{user.comments}}</div>
                        <div *ngIf="user.dateTime" class="black"><b>Date : </b> {{user.dateTime}}</div>
                      </li>
                    </div>
                    <div *ngIf="data.allUserApproval && data.userApprovalList.length == 0">
                      <li *ngFor="let user of data.userArray;let i = index ">{{i+1}}.{{user}}</li>
                    </div>
                    <div *ngIf="!data.allUserApproval">
                      <li *ngFor="let user of data.userArray;let i = index ">{{i+1}}.{{user}}
                        <div *ngIf="data.comments!=null && data.comments !='not applicable' && data.createdUserName === user" class="black"><b>Comments :</b> {{data.comments}}</div>
                        <div *ngIf="data.createdTime!=null && data.createdTime !='not applicable' && data.createdUserName === user" class="black"><b>Created Time :</b>&nbsp;{{data.createdTime}}</div>
                      </li>
                    </div>
                  </div>
                  <div *ngIf="data.externalApprovalList.length >0">
                    <b class="black"><u>External Approval</u></b>
                    <li *ngFor="let user of data.externalApprovalList;let i = index ">
                      {{i+1}}.{{user.user}}
                      <div *ngIf="user.comments" class="black"><b>Comments : </b> {{user.comments}}</div>
                      <div *ngIf="user.dateTime" class="black"><b>Date : </b> {{user.dateTime}}</div>
                    </li>
                  </div><br>
                  
                 
    </div>
    </label>
    </li>
    </ul><br><br>
  </div>
  </div>
  <div *ngIf="this.spinnerFlag" class="loading">Loading&#8230;</div>
  </div>
  <div class="app-modal-footer">
  </div>
</app-modal-basic>