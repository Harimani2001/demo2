<div class="row" *ngIf="!iscreate && !viewIndividualEquipmentData">
  <div class="col-sm-12">
    <div class="col-sm-12" id="float-action">
      <app-card>
        <div class="row">
          <div class="col-sm-2">
            <angular2-multiselect name="locationName" [data]="this.locationList" id="locationId"
              (ngModelChange)="filterEquipment($event, this.qualificationStatus)" [(ngModel)]="this.location"
              [settings]="locationDropdownSettings"></angular2-multiselect>
          </div>
          <div class="col-sm-2">
            <angular2-multiselect *ngIf="this.tabs && this.tabs.activeId != 'tasks'" name="qualificationStatus"
              [data]="this.qualificationList" id="qualificationStatus"
              (ngModelChange)="filterEquipment(this.location, $event)" [(ngModel)]="this.qualificationStatus"
              [settings]="statusDropdownSettings"></angular2-multiselect>
          </div>
          <div class="col-sm-4">
            <span *ngIf="!equipmentCountFlag" class="asterisk required">*Note: Equipment Creation Limit is crossed.
              Please contact Admin if needed...!</span>
          </div>
          <div class="col-sm-4 text-right">
            <a *ngIf="this.tabs && this.tabs.activeId == 'draft' && tableView" href="javascript:" class="m-r-15"><img
                class="image-radius rounded-0 img-25" src="assets/icon/png-icons/search.png" alt="Search"
                placement="bottom" ngbTooltip="Search" (click)="this.showSearch=!this.showSearch"></a>
            <input *ngIf="this.tabs && this.tabs.activeId == 'draft' && this.showSearch && tableView" type="search"
              [(ngModel)]="filterQuery" (ngModelChange)="this.helper.setPaginator(table)"
              class="form-control input-sm full-data-search m-r-15" placeholder="Search">

            <a *ngIf="permissionModal.createButtonFlag && equipmentCountFlag" href="javascript:" class="m-r-15"><img
                class="image-radius rounded-0 img-27" src="assets/icon/png-icons/addDoc.png" alt="Add Equipment"
                placement="bottom" ngbTooltip="Add Equipment" (click)="onClickCreate()"></a>

            <a *ngIf="permissionModal.createButtonFlag && equipmentCountFlag" href="javascript:" class="m-r-15"><img
                class="image-radius rounded-0 img-25" src="assets/icon/png-icons/import.png" alt="Bulk Import"
                placement="bottom" ngbTooltip="Bulk Import" (click)="bulkEquipmentModal.show(); resetBulk();"></a>

            <a *ngIf="!tableView" href="javascript:" class="m-r-10"><img class="image-radius rounded-0 img-25"
                src="assets/icon/png-icons/tableView.png" alt="Table View" placement="bottom" ngbTooltip="Table view"
                (click)="changeview(true)"></a>

            <a *ngIf="tableView" href="javascript:" class="m-r-10"><img class="image-radius rounded-0 img-30"
                src="assets/icon/png-icons/cardView.png" alt="Card View" placement="bottom" ngbTooltip="Card View"
                (click)="changeview(false)"></a>

            <a href="javascript:" class="m-r-10"><img class="image-radius rounded-0 img-25"
                src="assets/icon/png-icons/tasks.png" alt="Tasks" placement="bottom" ngbTooltip="Tasks"
                (click)="showTasksTab();"></a>

            <a href="javascript:"><img class="image-radius rounded-0 img-25" src="assets/icon/png-icons/audit.png"
                alt="Audit Trail" placement="bottom" ngbTooltip="Audit Trail" (click)="showAuditTab();"></a>
          </div>
        </div>
      </app-card>
    </div>
    <br><br>

    <app-card>
      <ngb-tabset #equipmentTab="ngbTabset" (tabChange)="onTabChange($event.nextId);">
        <ngb-tab id="draft" title="Equipments">
          <ng-template ngbTabContent>
            <app-card [cardClass]="'card-current-prog'" *ngIf="!tableView && this.groupedData">
              <div style="overflow-x: scroll; display: -webkit-box;">
                <div *ngFor="let item of this.groupedData" class="m-r-10 w-25">
                  <div class="green-contain-card"
                    [ngStyle]="{'background-color' : item.key === 'Not Completed' ? '#337ab7' : item.key === 'In Process' ? '#f0ad4e' : item.key === 'Completed' ? '#5cb85c' : item.key === 'Controlled by SOPs' ? 'coral' : 'slategrey'}">
                    <div style="padding: 10px 10px 2px 10px;">
                      <h6 style="color: aliceblue;">{{item.key}}</h6>
                    </div>
                    <div style="background-color: lightgray; padding: 10px; max-height: 400px; overflow-y: scroll;">
                      <app-card *ngFor="let dto of item.value">
                        <span style="text-overflow: ellipsis;
                              display: -webkit-box;
                              -webkit-line-clamp: 2;
                              overflow: hidden !important;
                              -webkit-box-orient: vertical;">
                          <strong class="strong">{{dto.name}}</strong>

                          <ng-template #popUsersInWorkFlow>
                            <ng-container>
                              <ul class="list-group list-group-flush"
                                *ngFor="let proj of dto.projectList; let i = index"
                                style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">
                                <label>{{proj}}</label>
                              </ul>
                            </ng-container>
                          </ng-template>
                          <a *ngIf="permissionModal.viewButtonFlag" container="body" href="javascript:;"
                            class="crm-action-view text-muted text-warning float-right"
                            (click)="viewRowDetails(dto.id);" data-ng-open="modalSmall" placement="top"
                            ngbTooltip="View">
                            <i class="icofont icofont-resize view"></i>
                          </a>
                          <a container="body" href="javascript:;" *ngIf="permissionModal.deleteButtonFlag"
                            class="m-r-5 crm-action-delete text-muted text-danger float-right"
                            (click)="openSuccessCancelSwal(dto , dto['$$index'] );" placement="top" ngbTooltip="Delete">
                            <i class="icofont icofont-bin bin"></i>
                          </a>
                          <a *ngIf="permissionModal.createButtonFlag && equipmentCountFlag" href="javascript:;"
                            (click)="cloneOfEquipment(dto)" container="body"
                            class="m-r-5 crm-action-edit text-muted text-primary float-right" placement="top"
                            ngbTooltip="Copy">
                            <i class="icofont icofont-copy"></i>
                          </a>
                          <a container="body" href="javascript:;" *ngIf="permissionModal.updateButtonFlag"
                            (click)="editEquipmet(dto)"
                            class="m-r-5 crm-action-edit text-muted text-primary float-right" placement="top"
                            ngbTooltip="Edit">
                            <i class="icofont icofont-edit edit"></i>
                          </a>
                          <a *ngIf="dto.projectList && dto.projectList.length>0" container="body" href="javascript:;"
                            class="m-r-5 crm-action-info text-muted text-primary float-right" placement="top"
                            triggers="mouseenter:mouseleave" [ngbPopover]="popUsersInWorkFlow">
                            <i class="icofont icofont-info-square info"></i>
                          </a>
                        </span>
                        <span *ngIf="dto.category" class="font-size-12px">
                          <hr class="horzontal_line">
                          <strong>Category</strong> : {{dto.category}}
                        </span>
                        <span *ngIf="dto.departmentName" class="font-size-12px">
                          <hr class="horzontal_line">
                          <strong>Department</strong> : {{dto.departmentName}}
                        </span>
                        <span *ngIf="dto.systemOwnerName" class="font-size-12px">
                          <hr class="horzontal_line">
                          <strong>System Owner</strong> : {{dto.systemOwnerName}}
                        </span>
                        <hr *ngIf="dto.description" class="horzontal_line">
                        <span *ngIf="dto.description" class="font-size-12px d-flex">
                          <strong>Description</strong> : <span
                            class="text-overflow-dots m-l-5">{{dto.description}}</span>
                        </span>
                        <span *ngIf="dto.gxpRelevence" class="font-size-12px">
                          <hr class="horzontal_line">
                          <strong>GxP Relevance Status : </strong><span class="text-warning">{{dto.gxpRelevence}}</span>
                        </span>
                        <span *ngIf="dto.dateOfPurchase" class="font-size-12px">
                          <hr class="horzontal_line">
                          <strong>Date of Purchase</strong> : {{dto.dateOfPurchase | date:this.datePipeFormat}}
                        </span>
                        <span *ngIf="dto.iqCompletionDate || dto.oqCompletionDate" class="font-size-12px">
                          <hr class="horzontal_line">
                          <strong>IQ Date</strong> : {{dto.iqCompletionDate | date:this.datePipeFormat}}
                          <span class="m-l-10">|<strong class="m-l-10">OQ Date</strong> : {{dto.oqCompletionDate |
                            date:this.datePipeFormat}}</span>
                        </span>
                        <span *ngIf="dto.releaseDate" class="font-size-12px">
                          <hr class="horzontal_line">
                          <strong>Release Date</strong> : {{dto.releaseDate | date:this.datePipeFormat}}
                        </span>
                        <span *ngIf="dto.periodicReview" class="font-size-12px">
                          <hr class="horzontal_line">
                          <strong>Periodic Review</strong> : {{dto.periodicReview | date:this.datePipeFormat}}
                        </span>
                        <!-- <span *ngIf="dto.checklistName" class="font-size-12px">
                          <hr class="horzontal_line">
                          <strong>Status</strong> : {{dto.checklistName}}
                        </span> -->
                        <span class="font-size-12px">
                          <hr class="horzontal_line">
                          <strong>Task :</strong>
                          <span class="blue m-r-5" style="cursor: pointer;" (click)="showTaskModel(dto, 'open')">
                            <strong>Open/In Progress</strong> : {{dto.equipmentTask.pendingCount}}</span>
                          |
                          <span class="green m-l-5" style="cursor: pointer;" (click)="showTaskModel(dto, 'completed')">
                            <strong>Completed</strong> : {{dto.equipmentTask.completedCount}}</span>
                        </span>
                      </app-card>
                    </div>
                  </div>
                </div>
              </div>
            </app-card>

            <ngx-datatable #myTable *ngIf="tableView" [scrollbarH]="true" class="data-table dt-chk"
              [rows]='equipmentData | EquipmentFilterPipe : filterQuery' [limit]="10" [columnMode]="'force'"
              [headerHeight]="50" [footerHeight]="50" [rowHeight]="'auto'">
              <ngx-datatable-row-detail [rowHeight]="'auto'" #myDetailRow>
                <ng-template let-row="row" let-expanded="expanded" ngx-datatable-row-detail-template>
                  <div class="dt-desc">
                    <table class="table-striped table-bordered">
                      <tr>
                        <th colspan="2">
                          <strong>Equipment Description</strong>
                        </th>
                      </tr>
                      <tr>
                        <td>Category</td>
                        <td style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">
                          {{row.category}}</td>
                      </tr>
                      <tr>
                        <td>Supplied / Sold By</td>
                        <td style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">
                          {{row.soldBy}}</td>
                      </tr>
                      <tr>
                        <td>Model</td>
                        <td style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">
                          {{row.model}}
                        </td>
                      </tr>
                      <tr>
                        <td>Manufacturer</td>
                        <td style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">
                          {{row.manufacturer}}
                        </td>
                      </tr>
                      <tr>
                        <td>Total Capacity </td>
                        <td style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">
                          {{row.totalCapacity}}
                        </td>
                      </tr>
                      <tr>
                        <td>Recommended usage Capacity</td>
                        <td style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">
                          {{row.usageCapacity}}
                        </td>
                      </tr>
                      <tr>
                        <td>Initial IQ completion Date</td>
                        <td style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">
                          {{row.iqCompletionDate| date:this.datePipeFormat}}
                        </td>
                      </tr>
                      <tr>
                        <td>Initial OQ completion Date</td>
                        <td style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">
                          {{row.oqCompletionDate| date:this.datePipeFormat}}
                        </td>
                      </tr>
                      <tr>
                      </tr>
                    </table>
                  </div>
                </ng-template>
              </ngx-datatable-row-detail>
              <ngx-datatable-column [width]="30" [resizeable]="false" [sortable]="false" [draggable]="false"
                [canAutoResize]="false">
                <ng-template let-row="row" let-expanded="expanded" ngx-datatable-cell-template>
                  <a href="javascript:;" [class.datatable-icon-right]="!expanded" [class.datatable-icon-down]="expanded"
                    title="Expand/Collapse Row" (click)="toggleExpandRow(row)">
                  </a>
                </ng-template>
              </ngx-datatable-column>
              <ngx-datatable-column [width]="60" [sortable]="false" [canAutoResize]="false" [draggable]="false"
                [resizeable]="false" name="Sl No.">
                <ng-template let-row="row" ngx-datatable-cell-template>
                  <strong>{{row['$$index']+1}}</strong>
                </ng-template>
              </ngx-datatable-column>
              <ngx-datatable-column style="font-weight: bold;" name="Name">
                <ng-template let-row="row" let-expanded="expanded" ngx-datatable-cell-template>
                  <strong
                    style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">{{row['name']}}</strong>
                </ng-template>
              </ngx-datatable-column>
              <ngx-datatable-column style="font-weight: bold;" name="Qualification Status">
                <ng-template let-row="row" let-expanded="expanded" ngx-datatable-cell-template>
                  <strong
                    style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">{{row['qualificationStatus']}}</strong>
                </ng-template>
              </ngx-datatable-column>
              <ngx-datatable-column style="font-weight: bold;" [width]="100" [canAutoResize]="false"
                [resizeable]="false" name="GxP Status">
                <ng-template let-row="row" let-expanded="expanded" ngx-datatable-cell-template>
                  <strong
                    style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">{{row['gxpRelevence']}}</strong>
                </ng-template>
              </ngx-datatable-column>
              <ngx-datatable-column style="font-weight: bold;" name="Date Of Purchase">
                <ng-template let-row="row" let-expanded="expanded" ngx-datatable-cell-template>
                  <strong
                    style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">{{row['dateOfPurchase']
                    | date:this.datePipeFormat}}</strong>
                </ng-template>
              </ngx-datatable-column>
              <ngx-datatable-column style="font-weight: bold;" name="Release Date">
                <ng-template let-row="row" let-expanded="expanded" ngx-datatable-cell-template>
                  <strong
                    style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">{{row['releaseDate']
                    | date:this.datePipeFormat}}</strong>
                </ng-template>
              </ngx-datatable-column>
              <ngx-datatable-column style="font-weight: bold;" name="Periodic Review ">
                <ng-template let-row="row" let-expanded="expanded" ngx-datatable-cell-template>
                  <strong
                    style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">{{row['periodicReview']
                    | date:this.datePipeFormat}}</strong>
                </ng-template>
              </ngx-datatable-column>
              <ngx-datatable-column style="font-weight: bold;" [width]="100" [canAutoResize]="false"
                [resizeable]="false" name="Status">
                <ng-template let-row="row" let-expanded="expanded" ngx-datatable-cell-template>
                  <strong
                    style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">{{row['activeString']}}</strong>
                </ng-template>
              </ngx-datatable-column>
              <ngx-datatable-column style="font-weight: bold;" [width]="100" [canAutoResize]="false"
                [resizeable]="false" name="Task(Open)">
                <ng-template let-row="row" let-expanded="expanded" ngx-datatable-cell-template>
                  <span class="blue m-r-5"
                    style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal; cursor: pointer;"
                    (click)="showTaskModel(row, 'open')">{{row['equipmentTask'].pendingCount}}</span>
                </ng-template>
              </ngx-datatable-column>
              <ngx-datatable-column [width]="200" [canAutoResize]="false" [resizeable]="false" [sortable]="false"
                name="Action">
                <ng-template let-row="row" ngx-datatable-cell-template>
                  <ng-template #popUsersInWorkFlow>
                    <ng-container *ngIf="row.projectList">
                      <ul class="list-group list-group-flush" *ngFor="let proj of row.projectList; let i = index"
                        style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">
                        <label>{{proj}}</label>
                      </ul>
                    </ng-container>
                  </ng-template>
                  <a container="body" href="javascript:;" class="m-r-15 crm-action-edit text-muted text-primary"
                    placement="top" triggers="mouseenter:mouseleave" [ngbPopover]="popUsersInWorkFlow">
                    <i class="icofont icofont-info-square info"></i>
                  </a>
                  <a container="body" href="javascript:;" *ngIf="permissionModal.updateButtonFlag"
                    (click)="editEquipmet(row)" class="m-r-15 crm-action-edit text-muted text-primary" placement="top"
                    ngbTooltip="Edit">
                    <i class="icofont icofont-edit edit"></i>
                  </a>
                  <a *ngIf="permissionModal.createButtonFlag && equipmentCountFlag" href="javascript:;"
                    (click)="cloneOfEquipment(row)" container="body"
                    class="m-r-15 crm-action-edit text-muted text-primary" placement="top" ngbTooltip="Copy">
                    <i class="icofont icofont-copy"></i>
                  </a>
                  <a container="body" href="javascript:;" *ngIf="permissionModal.deleteButtonFlag"
                    class="m-r-15 crm-action-delete text-muted text-danger"
                    (click)="openSuccessCancelSwal(row , row['$$index'] );" placement="top" ngbTooltip="Delete">
                    <i class="icofont icofont-bin bin"></i>
                  </a>
                  <a *ngIf="permissionModal.viewButtonFlag" container="body" href="javascript:;"
                    class="crm-action-view text-muted text-warning" (click)="viewRowDetails(row.id);"
                    data-ng-open="modalSmall" placement="top" ngbTooltip="View">
                    <i class="icofont icofont-resize view"></i></a>
                </ng-template>
              </ngx-datatable-column>
            </ngx-datatable>
          </ng-template>
        </ngb-tab>
        <ngb-tab *ngIf="this.showTasks" id="tasks" title="Tasks">
          <ng-template ngbTabContent>
            <app-card *ngIf="openTaskList && openTaskList.length>0">
              <div class="table-responsive">
                <table id="dtBasicExample" class="table table-bordered" [mfData]="openTaskList" #mf="mfDataTable">
                  <tbody>
                    <ng-container *ngFor="let row of openTaskList; let i=index;">
                      <tr>
                        <th colspan="6">{{row.key}}</th>
                      </tr>

                      <tr class="lightGary" width="100%">
                        <th>Task Id</th>
                        <th>Title</th>
                        <th>Due Date</th>
                        <th>Status</th>
                        <th>Assigned To</th>
                        <th>Action</th>
                      </tr>

                      <tr *ngFor="let dto of row.value ; let j=index;">
                        <td>{{dto.taskCode}}</td>
                        <td>{{dto.taskTitle}}</td>
                        <td>{{dto.dueDate}}</td>
                        <td>{{dto.status}}</td>
                        <td>{{dto.selectedUserNames}}</td>
                        <td>
                          <a container="body" href="javascript:;" class="crm-action-view text-muted text-warning"
                            (click)="navigateToTask(dto.id);" placement="top" ngbTooltip="View">
                            <i class="icofont icofont-resize view"></i></a>
                        </td>
                      </tr>
                    </ng-container>
                  </tbody>
                </table>
              </div>
            </app-card>
          </ng-template>
        </ngb-tab>
        <ngb-tab *ngIf="this.showAudit" id="audit" title="Audit Trail">
          <ng-template ngbTabContent>
            <app-audit-trail-view #auditView [permission]="this.helper.EQUIPMENT_VALUE"></app-audit-trail-view>
          </ng-template>
        </ngb-tab>
      </ngb-tabset>
    </app-card>
  </div>
</div>

<div *ngIf="iscreate" class="row">
  <div class="col-sm-12">
    <app-card>
      <div class="col-sm-12" id="float-action">
        <app-card>
          <div class="row">
            <div class="page-header-title col-sm-4">
              <i class="icofont icofont-washing-machine bg-c-blue"></i>
              <div class="d-inline">
                <h4 *ngIf="isSave" style="padding-top: 15px;">Equipment</h4>
                <h5 class="strong" *ngIf="isUpdate">{{this.modal.name}}</h5><br>
                <span *ngIf="isUpdate">Equipment Code : {{this.modal.code}}</span>
              </div>
            </div>
            <div class="col-sm-8 text-right">
              <button type="button" *ngIf="isUpdate" class="btn btn-sm btn-success waves-effect waves-light m-r-10"
                (click)="openSuccessUpdateSwal(onEquipmentForm);">Update</button>
              <button type="button" *ngIf="isSave" class="btn btn-sm btn-success waves-effect waves-light m-r-10"
                (click)="onClickSave(onEquipmentForm);">Save</button>
              <button type="button" class="btn btn-sm btn-danger  waves-effect waves-light m-r-10"
                (click)="onClickCancel()">Cancel</button>
            </div>
          </div>
        </app-card>
      </div><br><br><br>

      <form [formGroup]="onEquipmentForm">
        <table id="equipment-table" class="table w-100">
          <tbody>
            <tr>
              <td>
                <div class="row">
                  <div class="col-sm-3">
                    <strong class="strong">Equipment Name<span class="asterisk">*</span>:</strong>
                  </div>
                  <div class="col-sm-9">
                    <input #equipmentName type="text" name="equName" class="form-control" placeholder="name"
                      formControlName="name" maxlength="50" (blur)="onChangeName()" required>
                    <div class="messages text-danger" *ngIf="isValidName">
                      {{equipmentErrorTypes.equipmentNameValidation}}</div>
                    <div class="messages text-danger"
                      *ngIf="onEquipmentForm.get('name').touched && onEquipmentForm.get('name').hasError('required')">
                      {{equipmentErrorTypes.equipmentNameRequiredValidation}}</div>
                  </div>
                </div>
              </td>
              <td>
                <div class="row">
                  <div class="col-sm-3">
                    <strong class="strong">Equipment Code<span class="asterisk">*</span>:</strong>
                  </div>
                  <div class="col-sm-9">
                    <input type="text" name="eqpCode" class="form-control" placeholder="#123" formControlName="code"
                      maxlength="50" required>
                    <div class="messages text-danger"
                      *ngIf="onEquipmentForm.get('code').touched && onEquipmentForm.get('code').hasError('required')">
                      {{equipmentErrorTypes.equipmentCodeRequiredValidation}}</div>
                  </div>
                </div>
              </td>
            </tr>
            <tr>
              <td>
                <div class="row">
                  <div class="col-sm-3">
                    <strong class="strong">Category:</strong>
                  </div>
                  <div class="col-sm-9">
                    <select name="eqpCategory" class="form-control" formControlName="category">
                      <option value="">Select Category</option>
                      <option *ngFor="let category of equipmentCategoryList" [value]="category.key">{{category.value}}
                      </option>
                    </select>
                  </div>
                </div>
              </td>
              <td>
                <div class="row">
                  <div class="col-sm-3">
                    <strong class="strong">Location<span class="asterisk">*</span>:</strong>
                  </div>
                  <div class="col-sm-9">
                    <select name="eqpLocations" class="form-control" (ngModelChange)="onChangeLocation($event)"
                      formControlName="locationId">
                      <option value="">Select Location</option>
                      <option *ngFor="let loc of locationList" [value]="loc.id">{{loc.itemName}}</option>
                    </select>
                    <div class="messages text-danger"
                      *ngIf="(onEquipmentForm.get('locationId').touched || submitted) && onEquipmentForm.get('locationId').value==''">
                      {{equipmentErrorTypes.locationIdRequiredValidation}}</div>
                  </div>
                </div>
              </td>
            </tr>
            <tr>
              <td>
                <div class="row">
                  <div class="col-sm-3">
                    <strong class="strong">Department:</strong>
                  </div>
                  <div class="col-sm-9">
                    <ng-select [ngClass]="'ng-select'" [options]="departmentList" [multiple]="true"
                      (deselected)="onDeSelectDepartment($event)" formControlName="departments"
                      (selected)="getDeptUsers()" name="department">
                    </ng-select>
                  </div>
                </div>
              </td>
              <td>
                <div class="row">
                  <div class="col-sm-3">
                    <strong class="strong">System Owner:</strong>
                  </div>
                  <div class="col-sm-9">
                    <ng-select [ngClass]="'ng-select'" [options]="userList" [multiple]="true"
                      formControlName="systemOwner" name="systemOwner">
                    </ng-select>
                  </div>
                </div>
              </td>
            </tr>
            <tr>
              <td>
                <div class="row">
                  <div class="col-sm-3">
                    <strong class="strong">Description:</strong>
                  </div>
                  <div class="col-sm-9">
                    <textarea class="form-control max-textarea" formControlName="description" rows="2"
                      name="description" placeholder="Description" maxlength="200"></textarea>
                  </div>
                </div>
              </td>
              <td>
                <div class="row">
                  <div class="col-sm-3">
                    <strong class="strong">Component:</strong>
                  </div>
                  <div class="col-sm-9">
                    <textarea class="form-control max-textarea" formControlName="component" rows="2" name="component"
                      placeholder="Component" maxlength="200"></textarea>
                  </div>
                </div>
              </td>
            </tr>
            <tr>
              <td>
                <div class="row">
                  <div class="col-sm-3">
                    <strong class="strong">Qualification Status<span class="asterisk">*</span>:</strong>
                  </div>
                  <div class="col-sm-9">
                    <select name="qualification" class="form-control" formControlName="qualificationStatus">
                      <option value="">Select Qualification Status</option>
                      <option *ngFor="let qual of qualificationList" [value]="qual.id">{{qual.itemName}}</option>
                    </select>
                    <div class="messages text-danger"
                      *ngIf="(onEquipmentForm.get('qualificationStatus').touched || submitted) && onEquipmentForm.get('qualificationStatus').value==''">
                      {{equipmentErrorTypes.qualificationStatusRequiredValidation}}</div>
                  </div>
                </div>
              </td>
              <td>
                <div class="row">
                  <div class="col-sm-3">
                    <strong class="strong">GxP Relevance Status:</strong>
                  </div>
                  <div class="col-sm-9">
                    <select name="gxpRelevence" class="form-control" formControlName="gxpRelevence">
                      <option value="">Select GxP Relevance Status</option>
                      <option *ngFor="let gxp of gxpRelevanceList" [value]="gxp.key">{{gxp.value}}</option>
                    </select>
                  </div>
                </div>
              </td>
            </tr>
            <tr>
              <td>
                <div class="row">
                  <div class="col-sm-3">
                    <strong class="strong">Model:</strong>
                  </div>
                  <div class="col-sm-9">
                    <input type="text" name="eqpModel" class="form-control" placeholder="Model" formControlName="model"
                      maxlength="50">
                  </div>
                </div>
              </td>
              <td>
                <div class="row">
                  <div class="col-sm-3">
                    <strong class="strong">Date of Purchase:</strong>
                  </div>
                  <div class="col-sm-9">
                    <input class="form-control" name="a" mwlFlatpickr formControlName="dateOfPurchase"
                      readonly="readonly" [altInput]="true" [convertModelValue]="true" [enableTime]="false"
                      dateFormat="Y-m-dTH:i" [altFormat]="this.pattern" placeholder="Date Of Purchase"
                      [maxDate]="today" />
                  </div>
                </div>
              </td>
            </tr>
            <tr>
              <td>
                <div class="row">
                  <div class="col-sm-3">
                    <strong class="strong">Make / Manufactured By:</strong>
                  </div>
                  <div class="col-sm-9">
                    <input type="text" name="eqpManBy" class="form-control" placeholder="manufacturer"
                      formControlName="manufacturer" maxlength="50">
                  </div>
                </div>
              </td>
              <td>
                <div class="row">
                  <div class="col-sm-3">
                    <strong class="strong">Supplied / Sold By:</strong>
                  </div>
                  <div class="col-sm-9">
                    <input type="text" name="eqpSoldBy" class="form-control" placeholder="Supplied / Sold By"
                      formControlName="soldBy" maxlength="50">
                  </div>
                </div>
              </td>
            </tr>
            <tr>
              <td>
                <div class="row">
                  <div class="col-sm-3">
                    <strong class="strong">Total Capacity:</strong>
                  </div>
                  <div class="col-sm-9">
                    <input type="text" name="eqpTotalCapacity" class="form-control" placeholder="Total Capacity"
                      formControlName="totalCapacity" maxlength="50">
                  </div>
                </div>
              </td>
              <td>
                <div class="row">
                  <div class="col-sm-3">
                    <strong class="strong">Recommended Usage Capacity:</strong>
                  </div>
                  <div class="col-sm-9">
                    <input type="text" name="eqpUsageCapacity" class="form-control"
                      placeholder="Recommended Usage Capacity" formControlName="usageCapacity" maxlength="50">
                  </div>
                </div>
              </td>
            </tr>
            <tr>
              <td>
                <div class="row">
                  <div class="col-sm-3">
                    <strong class="strong">Initial IQ Completion Date:</strong>
                  </div>
                  <div class="col-sm-9">
                    <input class="form-control" name="b" mwlFlatpickr formControlName="IQCompletionDate"
                      readonly="readonly" [altInput]="true" [convertModelValue]="true" [enableTime]="false"
                      dateFormat="Y-m-dTH:i" [altFormat]="this.pattern" placeholder="Initial IQ completion Date"
                      [maxDate]="today" />
                  </div>
                </div>
              </td>
              <td>
                <div class="row">
                  <div class="col-sm-3">
                    <strong class="strong">Initial OQ Completion Date:</strong>
                  </div>
                  <div class="col-sm-9">
                    <input class="form-control" name="c" mwlFlatpickr formControlName="OQCompletionDate"
                      readonly="readonly" [altInput]="true" [convertModelValue]="true" [enableTime]="false"
                      dateFormat="Y-m-dTH:i" [altFormat]="this.pattern" placeholder="Initial OQ completion Date"
                      [maxDate]="today" />
                  </div>
                </div>
              </td>
            </tr>
            <tr>
              <td>
                <div class="row">
                  <div class="col-sm-3">
                    <strong class="strong">Release Date:</strong>
                  </div>
                  <div class="col-sm-9">
                    <input class="form-control" name="i" mwlFlatpickr formControlName="releaseDate" readonly="readonly"
                      [altInput]="true" [convertModelValue]="true" [enableTime]="false" dateFormat="Y-m-dTH:i"
                      [altFormat]="this.pattern" placeholder="Release Date" [maxDate]="today" />
                  </div>
                </div>
              </td>
              <td>
                <div class="row">
                  <div class="col-sm-3">
                    <strong class="strong">Periodic Review:</strong>
                  </div>
                  <div class="col-sm-9">
                    <input class="form-control" name="j" mwlFlatpickr formControlName="periodicReview"
                      readonly="readonly" [altInput]="true" [convertModelValue]="true" [enableTime]="false"
                      dateFormat="Y-m-dTH:i" [altFormat]="this.pattern" placeholder="Periodic Review"
                      [maxDate]="today" />
                  </div>
                </div>
              </td>
            </tr>
            <tr>
              <td colspan="2">
                <div class="row">
                  <div class="col-sm-2">
                    <strong class="strong">Active Flag:</strong>
                  </div>
                  <div class="col-sm-10">
                    <label class="switch">
                      <input type="checkbox" name="activeFlag" formControlName="active" />
                      <span class="slider round"></span>
                    </label>
                  </div>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
        <div>
          <div class="form-group row">
            <span class="p-l-20"><i class="icofont icofont-checked"></i> Status</span>
          </div>
          <button class="btn btn-primary btn-sm p-l-20" (click)="addChecklistItem()">
            Add new
          </button>
          <br>
          <ng-container *ngIf="modal.checklist.length>0">
            <div class="col-sm-12">
              <table id="equipment-table-checkList" class="table">
                <thead class="panel-heading">
                  <tr class="w-100">
                    <td class="w-40"><label class="strong">Name</label></td>
                    <td class="w-10"><label class="strong">Display Order</label></td>
                    <td class="w-20"><label class="strong">Actions</label></td>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let checkList of modal.checklist; let i = index;">
                    <td>
                      <input type="text" id="name-{{i}}" class="form-control" [(ngModel)]="checkList.checklistName"
                        [ngModelOptions]="{standalone: true}" />
                    </td>
                    <td width="10px">
                      <input type="number" class="form-control" [(ngModel)]="checkList.displayOrder"
                        [ngModelOptions]="{standalone: true}" />
                    </td>
                    <td width="10px">
                      <i style="cursor: pointer;" (click)="deleteCheckList(checkList)" class="icofont icofont-ui-delete"
                        title="delete"></i>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </ng-container>
        </div>
        <div style="color: red;" *ngIf="isCheckListEntered">Please Fill the Details to Continue . . .</div>
        <div style="color: red;" *ngIf="this.isValidDocumentOrder">Display Order can't be Duplicate . . .
          <br>
        </div>
        <div class="form-group row">
          <label class="col-sm-2 col-form-label">Image
          </label>
          <label class="col-sm-10">
            <input type='file' accept=".png,.jpg" (change)="onSelectFile($event)">
            <h6 style="font-size: 12px"><span class="asterisk required">*</span>Note: Upload .png,.jpg files only
            </h6>
            <br>
            <img *ngIf="this.modal.selectedFile != null && this.modal.selectedFile != ''"
              [src]="this.modal.selectedFile" height="128" width="128">
          </label>
        </div>
        <div *ngIf="this.inputField">
          <app-form-extended #formExtendedId [(inputField)]='inputField' [documentId]="this.helper.EQUIPMENT_VALUE"
            [(submitted)]='submitted'></app-form-extended>
        </div>
      </form>
    </app-card>
  </div>
</div>
<div *ngIf="spinnerFlag" class="loading">Loading&#8230;</div>

<div class="col-sm-12" *ngIf="this.viewIndividualEquipmentData==true" id="float-action">
  <app-card>
    <div class="row">
      <div class="page-header-title col-sm-4">
        <i class="icofont icofont-washing-machine bg-c-blue"></i>
        <div class="d-inline">
          <h4 *ngIf="this.viewIndividualEquipmentData!=true" style="padding-top: 15px;">Equipment</h4>
          <h5 *ngIf="this.viewIndividualEquipmentData==true" class="strong">{{equipmentViewData.name}}</h5>
          <br>
          <span *ngIf="this.viewIndividualEquipmentData==true">Equipment Code : {{equipmentViewData.code}}</span>
        </div>
      </div>
      <div class="col-sm-8 text-right">
        <button *ngIf="this.viewIndividualEquipmentData==true && permissionModal.updateButtonFlag" type="submit"
          (click)="editEquipmet(equipmentViewData);this.viewIndividualEquipmentData=false"
          class="btn btn-sm btn-primary  waves-effect waves-light m-r-10">Edit</button>
        <button type="button" *ngIf="this.viewIndividualEquipmentData==true"
          class="btn btn-sm btn-danger  waves-effect waves-light m-r-10"
          (click)="this.viewIndividualEquipmentData=false; this.submitted=false">Cancel</button>
      </div>
    </div>
  </app-card>
</div>
<br><br><br>

<app-card *ngIf="this.viewIndividualEquipmentData==true">
  <div class="row">
    <div class="col-sm-12">
      <table id="add-table" class="table w-100">
        <tbody>
          <tr *ngIf="equipmentViewData.category || equipmentViewData.locationName">
            <td>
              <div><strong class="strong">Category : </strong>{{equipmentViewData.category}}</div>
            </td>
            <td>
              <div><strong class="strong">Location : </strong>{{equipmentViewData.locationName}}</div>
            </td>
          </tr>
          <tr *ngIf="equipmentViewData.departmentName || equipmentViewData.systemOwnerName">
            <td>
              <div><strong class="strong">Department : </strong>{{equipmentViewData.departmentName}}</div>
            </td>
            <td>
              <div><strong class="strong">System Owner : </strong>{{equipmentViewData.systemOwnerName}}</div>
            </td>
          </tr>
          <tr *ngIf="equipmentViewData.description || equipmentViewData.component">
            <td>
              <div><strong class="strong">Description : </strong>{{equipmentViewData.description}}</div>
            </td>
            <td>
              <div><strong class="strong">Component : </strong>{{equipmentViewData.component}}</div>
            </td>
          </tr>
          <tr *ngIf="equipmentViewData.qualificationStatus || equipmentViewData.gxpRelevence">
            <td>
              <div><strong class="strong">Qualification Status : </strong><span
                  class="text-warning">{{equipmentViewData.qualificationStatus}}</span></div>
            </td>
            <td>
              <div><strong class="strong">GxP Relevance Status : </strong><span
                  class="text-warning">{{equipmentViewData.gxpRelevence}}</span></div>
            </td>
          </tr>
          <tr *ngIf="equipmentViewData.model || equipmentViewData.dateOfPurchase">
            <td>
              <div><strong class="strong">Model :</strong> {{equipmentViewData.model}}</div>
            </td>
            <td>
              <div><strong class="strong">Date of Purchase : </strong>{{equipmentViewData.dateOfPurchase |
                date:this.datePipeFormat}}
              </div>
            </td>
          </tr>
          <tr *ngIf="equipmentViewData.manufacturer || equipmentViewData.soldBy">
            <td>
              <div><strong class="strong">Make / Manufactured By : </strong>{{equipmentViewData.manufacturer}}</div>
            </td>
            <td>
              <div><strong class="strong">Supplied / Sold By : </strong>{{equipmentViewData.soldBy}}</div>
            </td>
          </tr>
          <tr *ngIf="equipmentViewData.totalCapacity || equipmentViewData.usageCapacity">
            <td>
              <div><strong class="strong">Total Capacity : </strong>{{equipmentViewData.totalCapacity}}</div>
            </td>
            <td>
              <div><strong class="strong">Recommended Usage Capacity : </strong>{{equipmentViewData.usageCapacity}}
              </div>
            </td>
          </tr>
          <tr *ngIf="equipmentViewData.iqCompletionDate || equipmentViewData.oqCompletionDate">
            <td>
              <div><strong class="strong">Initial IQ Completion Date : </strong>{{equipmentViewData.iqCompletionDate |
                date:this.datePipeFormat}}</div>
            </td>
            <td>
              <div><strong class="strong">Initial OQ Completion Date : </strong>{{equipmentViewData.oqCompletionDate |
                date:this.datePipeFormat}}</div>
            </td>
          </tr>
          <tr *ngIf="equipmentViewData.releaseDate || equipmentViewData.periodicReview">
            <td>
              <div><strong class="strong">Release Date : </strong>{{equipmentViewData.releaseDate |
                date:this.datePipeFormat}}</div>
            </td>
            <td>
              <div><strong class="strong">Periodic Review : </strong>{{equipmentViewData.periodicReview |
                date:this.datePipeFormat}}</div>
            </td>
          </tr>
          <tr *ngIf="this.equipmentViewData.selectedFile != null && this.equipmentViewData.selectedFile != ''">
            <td colspan="2">
              <div><strong class="strong">Image : </strong>
                <img [src]="this.equipmentViewData.selectedFile" height="128" width="128">
              </div>
            </td>
          </tr>
        </tbody>
      </table>

      <table id="equipment-table-checkList" class="table">
        <tr *ngFor="let item of equipmentViewData.checklist; let i = index">
          <td>
            <div class="row ">
              <div class="col-sm-12 ">
                <strong>{{i+1}}.</strong>
                <strong class="form-contol-label">{{item.checklistName}}</strong>
              </div>
            </div>
          </td>
        </tr>
      </table>

      <app-view-form [inputField]='this.popupdata'></app-view-form>
    </div>
  </div>

  <div>
    <h4 style="color: #014c8c;">Task List</h4>
    <ngb-tabset #taskTab="ngbTabset">
      <ngb-tab id="open" title="Open / Inprogress">
        <ng-template ngbTabContent>
          <ngx-datatable #pendingTable [scrollbarH]="true" class="data-table dt-chk" [rows]='pendingTaskList'
            [limit]="10" [columnMode]="'force'" [headerHeight]="50" [footerHeight]="50" [rowHeight]="'auto'">
            <ngx-datatable-column style="font-weight: bold;" name="Project Name">
              <ng-template let-row="row" let-expanded="expanded" ngx-datatable-cell-template>
                <strong
                  style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">{{row['globalProjectName']}}</strong>
              </ng-template>
            </ngx-datatable-column>
            <ngx-datatable-column style="font-weight: bold;" name="Task Id">
              <ng-template let-row="row" let-expanded="expanded" ngx-datatable-cell-template>
                <a [routerLink]="" (click)="redirect(row, this.equipmentViewData.id)"
                  style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">{{row['taskCode']}}</a>
              </ng-template>
            </ngx-datatable-column>
            <ngx-datatable-column style="font-weight: bold;" name="Description">
              <ng-template let-row="row" let-expanded="expanded" ngx-datatable-cell-template>
                <strong
                  style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">{{row['taskTitle']}}</strong>
              </ng-template>
            </ngx-datatable-column>
            <ngx-datatable-column style="font-weight: bold;" name="Due Date">
              <ng-template let-row="row" let-expanded="expanded" ngx-datatable-cell-template>
                <strong
                  style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">{{row['dueDate']}}</strong>
              </ng-template>
            </ngx-datatable-column>
            <ngx-datatable-column style="font-weight: bold;" name="Status">
              <ng-template let-row="row" let-expanded="expanded" ngx-datatable-cell-template>
                <strong
                  style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">{{row['status']}}</strong>
              </ng-template>
            </ngx-datatable-column>
            <ngx-datatable-column style="font-weight: bold;" name="Assigned To">
              <ng-template let-row="row" let-expanded="expanded" ngx-datatable-cell-template>
                <strong
                  style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">{{row['selectedUserNames']}}</strong>
              </ng-template>
            </ngx-datatable-column>
          </ngx-datatable>
        </ng-template>
      </ngb-tab>
      <ngb-tab id="completed" title="Completed">
        <ng-template ngbTabContent>
          <ngx-datatable #pendingTable [scrollbarH]="true" class="data-table dt-chk" [rows]='completeTaskList'
            [limit]="10" [columnMode]="'force'" [headerHeight]="50" [footerHeight]="50" [rowHeight]="'auto'">
            <ngx-datatable-column style="font-weight: bold;" name="Project Name">
              <ng-template let-row="row" let-expanded="expanded" ngx-datatable-cell-template>
                <strong
                  style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">{{row['globalProjectName']}}</strong>
              </ng-template>
            </ngx-datatable-column>
            <ngx-datatable-column style="font-weight: bold;" name="Task Id">
              <ng-template let-row="row" let-expanded="expanded" ngx-datatable-cell-template>
                <a [routerLink]="" (click)="redirect(row, this.equipmentViewData.id)"
                  style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">{{row['taskCode']}}</a>
              </ng-template>
            </ngx-datatable-column>
            <ngx-datatable-column style="font-weight: bold;" name="Description">
              <ng-template let-row="row" let-expanded="expanded" ngx-datatable-cell-template>
                <strong
                  style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">{{row['taskTitle']}}</strong>
              </ng-template>
            </ngx-datatable-column>
            <ngx-datatable-column style="font-weight: bold;" name="Due Date">
              <ng-template let-row="row" let-expanded="expanded" ngx-datatable-cell-template>
                <strong
                  style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">{{row['dueDate']}}</strong>
              </ng-template>
            </ngx-datatable-column>
            <ngx-datatable-column style="font-weight: bold;" name="Status">
              <ng-template let-row="row" let-expanded="expanded" ngx-datatable-cell-template>
                <strong
                  style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">{{row['status']}}</strong>
              </ng-template>
            </ngx-datatable-column>
            <ngx-datatable-column style="font-weight: bold;" name="Assigned To">
              <ng-template let-row="row" let-expanded="expanded" ngx-datatable-cell-template>
                <strong
                  style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">{{row['selectedUserNames']}}</strong>
              </ng-template>
            </ngx-datatable-column>
          </ngx-datatable>
        </ng-template>
      </ngb-tab>
    </ngb-tabset>
  </div>
  <br>
  <app-individual-audit-trail [permission]="this.helper.EQUIPMENT_VALUE" [id]="equipmentViewData.id">
  </app-individual-audit-trail>
</app-card>

<app-modal-basic #TaskModal [dialogClass]="'modal-lg'" class="modal-dialog modal-dialog-scrollable">
  <div class="app-modal-header">
    <h4 class="modal-title">Task List</h4>
    <button type="button" class="close basic-close" (click)="TaskModal.hide()">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="app-modal-body" *ngIf="TaskModal.visible">
    <ngx-datatable #pendingTable [scrollbarH]="true" class="data-table dt-chk" [rows]='equipmentTask' [limit]="10"
      [columnMode]="'force'" [headerHeight]="50" [footerHeight]="50" [rowHeight]="'auto'">
      <ngx-datatable-column style="font-weight: bold;" name="Project Name">
        <ng-template let-row="row" let-expanded="expanded" ngx-datatable-cell-template>
          <strong
            style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">{{row['globalProjectName']}}</strong>
        </ng-template>
      </ngx-datatable-column>
      <ngx-datatable-column style="font-weight: bold;" name="Task Id">
        <ng-template let-row="row" let-expanded="expanded" ngx-datatable-cell-template>
          <a [routerLink]="" (click)="redirect(row, '')"
            style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">{{row['taskCode']}}</a>
        </ng-template>
      </ngx-datatable-column>
      <ngx-datatable-column style="font-weight: bold;" name="Description">
        <ng-template let-row="row" let-expanded="expanded" ngx-datatable-cell-template>
          <strong
            style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">{{row['taskTitle']}}</strong>
        </ng-template>
      </ngx-datatable-column>
      <ngx-datatable-column style="font-weight: bold;" name="Due Date">
        <ng-template let-row="row" let-expanded="expanded" ngx-datatable-cell-template>
          <strong
            style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">{{row['dueDate']}}</strong>
        </ng-template>
      </ngx-datatable-column>
      <ngx-datatable-column style="font-weight: bold;" name="Status">
        <ng-template let-row="row" let-expanded="expanded" ngx-datatable-cell-template>
          <strong
            style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">{{row['status']}}</strong>
        </ng-template>
      </ngx-datatable-column>
      <ngx-datatable-column style="font-weight: bold;" name="Assigned To">
        <ng-template let-row="row" let-expanded="expanded" ngx-datatable-cell-template>
          <strong
            style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">{{row['selectedUserNames']}}</strong>
        </ng-template>
      </ngx-datatable-column>
    </ngx-datatable>
  </div>
</app-modal-basic>

<app-modal-basic #bulkEquipmentModal [dialogClass]="'modal-lg'">
  <div class="app-modal-header">
    <h4 class="modal-title">Bulk Import Equipment Excel</h4>
    <button type="button" class="close basic-close" (click)="bulkEquipmentModal.hide();closeBulkEquipmentModel()">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="app-modal-body" slimScroll railVisible="true" railColor="#004a6d" width="100%" height="400px" size="12px"
    color="#737373" opacity="0.6" allowPageScroll="false">
    <div class="row">
      <div class="col-sm-12">
        <div><button class="btn btn-primary" (click)="sampleBatchDownload();" style="float: right;"><i
              class="icofont icofont-download-alt"></i>Sample Download</button></div>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12">
        <div class="sub-title">Single File</div>
        <label class="custom-file">
          <input #myInput type="file" ng2FileSelect [uploader]="uploader" accept=".xls" (change)="extractFile($event);">
          <span class="custom-file-control"></span>
        </label>
      </div>
    </div>
    <br>
    <div class="col-sm-12">
      <div>
        <div style="color: darkgreen" *ngIf="this.validationMessage!=''">{{this.validationMessage}}</div>
      </div>
    </div>
    <ng-container>
      <div *ngIf="this.isUploaded" class="table-responsive ">
        <table id="tableIdDivRefresh1" #tableIdDivRefresh class="table table-striped table-bordered ">
          <thead>
            <tr>
              <th>Sr No.</th>
              <th>Equipment Name</th>
              <th>Equipment Code</th>
              <th>Category</th>
              <th>Location</th>
              <th>Department</th>
              <th>System Owner</th>
              <th>Description</th>
              <th>Component</th>
              <th>Qualification Status</th>
              <th>GxP Relevance Status</th>
              <th>Model</th>
              <th>Date of Purchase</th>
              <th>Make / Manufactured By</th>
              <th>Supplied / Sold By</th>
              <th>Total Capacity</th>
              <th>Recommended Usage Capacity</th>
              <th>Initial IQ Completion Date</th>
              <th>Initial OQ Completion Date</th>
              <th>Release Date</th>
              <th>Periodic Review</th>
              <th *ngFor="let column of formExtendedColumns">
                <label *ngIf="(column.type!='header' && column.type!='newline' && column.type!='paragraph')"
                  [innerHtml]='column.label'></label>
              </th>
            </tr>
          </thead>
          <tbody *ngFor="let row of excelData ; let i = index" [attr.data-index]="i">
            <tr>
              <td>
                <label>{{i+1}}</label>
              </td>
              <td>
                <input type="text" name="eqpName-{{i}}" class="form-control" [(ngModel)]="row.name" maxlength="50"
                  (ngModelChange)="checkEquipmentName(excelData, row)"
                  [ngStyle]="{'background-color': (row.name == '' || row.equipmentNameValMsg != '') ? '#FD3A4A' : 'white'}">
                <div class="messages text-danger" *ngIf="row.equipmentNameValMsg != ''">{{row.equipmentNameValMsg}}
                </div>
              </td>
              <td>
                <input type="text" name="eqpCode-{{i}}" class="form-control" [(ngModel)]="row.code" maxlength="50"
                  (ngModelChange)="checkEquipmentCode(excelData, row)"
                  [ngStyle]="{'background-color': (row.code == '' || row.equipmentCodeValMsg != '') ? '#FD3A4A' : 'white'}">
                <div class="messages text-danger" *ngIf="row.equipmentCodeValMsg != ''">{{row.equipmentCodeValMsg}}
                </div>
              </td>
              <td>
                <select name="eqpCategory-{{i}}" class="form-control" [(ngModel)]="row.category">
                  <option value="">Select Category</option>
                  <option *ngFor="let category of equipmentCategoryList" [value]="category.key">{{category.value}}
                  </option>
                </select>
              </td>
              <td>
                <select name="eqpLocations-{{i}}" class="form-control" [(ngModel)]="row.locationId"
                  (ngModelChange)="onBulkChangeLocation($event, row); checkLocation(excelData, row)"
                  [ngStyle]="{'background-color':(row.locationId && row.locationId!=0) ? 'white' : '#FD3A4A'}">
                  <option value="">Select Location</option>
                  <option *ngFor="let loc of locationList" [value]="loc.id">{{loc.itemName}}</option>
                </select>
                <div class="messages text-danger" *ngIf="row.locationValMsg != ''">{{row.locationValMsg}}</div>
              </td>
              <td>
                <ng-select [ngClass]="'ng-select'" [options]="row.departmentList" [multiple]="true"
                  (deselected)="onBulkDeSelectDepartment($event, row)" [(ngModel)]="row.departments"
                  (selected)="getBulkDeptUsers(row)" name="department-{{i}}">
                </ng-select>
              </td>
              <td>
                <ng-select [ngClass]="'ng-select'" [options]="row.systemOwnerList" [multiple]="true"
                  [(ngModel)]="row.systemOwner" name="systemOwner-{{i}}">
                </ng-select>
              </td>
              <td>
                <textarea class="form-control max-textarea" [(ngModel)]="row.description" rows="2"
                  name="description-{{i}}" maxlength="200"></textarea>
              </td>
              <td>
                <textarea class="form-control max-textarea" [(ngModel)]="row.component" rows="2" name="component-{{i}}"
                  maxlength="200"></textarea>
              </td>
              <td>
                <select name="qualification-{{i}}" class="form-control" [(ngModel)]="row.qualificationStatus"
                  (ngModelChange)="checkQualificationStatus(excelData, row)"
                  [ngStyle]="{'background-color': (row.qualificationStatus == '' || row.qualificationStatusValMsg != '') ? '#FD3A4A' : 'white'}">
                  <option value="">Select Qualification Status</option>
                  <option *ngFor="let qual of qualificationList" [value]="qual.id">{{qual.itemName}}</option>
                </select>
                <div class="messages text-danger" *ngIf="row.qualificationStatusValMsg != ''">
                  {{row.qualificationStatusValMsg}}</div>
              </td>
              <td>
                <select name="gxpRelevence-{{i}}" class="form-control" [(ngModel)]="row.gxpRelevence">
                  <option value="">Select GxP Relevance Status</option>
                  <option *ngFor="let gxp of gxpRelevanceList" [value]="gxp.key">{{gxp.value}}</option>
                </select>
              </td>
              <td>
                <input type="text" name="eqpModel" class="form-control" [(ngModel)]="row.model" maxlength="50">
              </td>
              <td>
                <input class="form-control" name="a-{{i}}" mwlFlatpickr [(ngModel)]="row.dateOfPurchase"
                  readonly="readonly" [altInput]="true" [convertModelValue]="true" [enableTime]="false"
                  dateFormat="Y-m-dTH:i" [altFormat]="this.pattern" [maxDate]="today" />
              </td>
              <td>
                <input type="text" name="eqpManBy-{{i}}" class="form-control" [(ngModel)]="row.manufacturer"
                  maxlength="50">
              </td>
              <td>
                <input type="text" name="eqpSoldBy-{{i}}" class="form-control" [(ngModel)]="row.soldBy" maxlength="50">
              </td>
              <td>
                <input type="text" name="eqpTotalCapacity-{{i}}" class="form-control" [(ngModel)]="row.totalCapacity"
                  maxlength="50">
              </td>
              <td>
                <input type="text" name="eqpUsageCapacity-{{i}}" class="form-control" [(ngModel)]="row.usageCapacity"
                  maxlength="50">
              </td>
              <td>
                <input class="form-control" name="b-{{i}}" mwlFlatpickr [(ngModel)]="row.iqCompletionDate"
                  readonly="readonly" [altInput]="true" [convertModelValue]="true" [enableTime]="false"
                  dateFormat="Y-m-dTH:i" [altFormat]="this.pattern" [maxDate]="today" />
              </td>
              <td>
                <input class="form-control" name="c-{{i}}" mwlFlatpickr [(ngModel)]="row.oqCompletionDate"
                  readonly="readonly" [altInput]="true" [convertModelValue]="true" [enableTime]="false"
                  dateFormat="Y-m-dTH:i" [altFormat]="this.pattern" [maxDate]="today" />
              </td>
              <td>
                <input class="form-control" name="i-{{i}}" mwlFlatpickr [(ngModel)]="row.releaseDate"
                  readonly="readonly" [altInput]="true" [convertModelValue]="true" [enableTime]="false"
                  dateFormat="Y-m-dTH:i" [altFormat]="this.pattern" [maxDate]="today" />
              </td>
              <td>
                <input class="form-control" name="j-{{i}}" mwlFlatpickr [(ngModel)]="row.periodicReview"
                  readonly="readonly" [altInput]="true" [convertModelValue]="true" [enableTime]="false"
                  dateFormat="Y-m-dTH:i" [altFormat]="this.pattern" [maxDate]="today" />
              </td>

              <td *ngFor="let column of row.jsonExtraData">
                <label *ngIf="(column.subtype=='Text')">
                  <input type="text" [name]='column.name' [(ngModel)]='column.value' [minlength]="column.minlength"
                    (ngModelChange)="fieldValidation(column)" [required]="column.required"
                    [maxlength]="column.maxlength" #text="ngModel"
                    [ngStyle]="{'background-color': !column.fieldError? 'white' : '#FD3A4A'}">
                  <div class="messages text-danger" *ngIf="(text.touched || submitted) && text.errors?.required">
                    <label [innerHtml]="column.label"></label> can't be blank
                  </div>
                </label>
                <label *ngIf="(column.subtype=='Email')">
                  <input type="email" [name]='column.name' [(ngModel)]='column.value'
                    (ngModelChange)="fieldValidation(column)" [pattern]="helper.email_pattern" #email="ngModel"
                    [ngStyle]="{'background-color': !column.fieldError? 'white' : '#FD3A4A'}">
                  <div class="messages text-danger" *ngIf="(email.touched || submitted) && email.errors?.required">
                    <label [innerHtml]="column.label"></label> can't be blank
                  </div>
                  <div class="messages text-danger" *ngIf="email.errors?.pattern">Please enter a valid Email Id
                  </div>
                </label>
                <label *ngIf="(column.subtype=='Mobile')">
                  <input type="tel" [name]='column.name' [(ngModel)]='column.value' pattern="^[6789]\d{9}$"
                    [ngStyle]="{'background-color': !column.fieldError? 'white' : '#FD3A4A'}"
                    (keypress)="onlyNumber($event)" #mobile="ngModel" (ngModelChange)="fieldValidation(column)">
                  <div class="messages text-danger" *ngIf="(mobile.touched || submitted) && mobile.errors?.required">
                    <label [innerHtml]="column.label"></label> can't be blank
                  </div>
                  <div class="messages text-danger" *ngIf="mobile.errors?.pattern">Please enter a valid <label
                      [innerHtml]="column.label"></label></div>
                </label>

                <label *ngIf="(column.type==='number')">
                  <input type="number" [disabled]="column.disabled" [name]='column.name' [(ngModel)]='column.value'
                    #number="ngModel" (keypress)="onlyNumber($event)" (ngModelChange)="fieldValidation(column)"
                    (ngModelChange)="calculationOfTableValue(column,row)" [minlength]="column.minlength"
                    [maxlength]="column.maxlength" [required]="column.required"
                    [ngStyle]="{'background-color': !column.fieldError? 'white' : '#FD3A4A'}">
                  <div class="messages text-danger" *ngIf="(number.touched || submitted) && number.errors?.required">
                    Enter valid <label [innerHtml]="column.label"></label></div>
                </label>
                <label *ngIf="(column.type==='date')">
                  <input type="date" [name]='column.name' [(ngModel)]='column.value'
                    (ngModelChange)="onChangeFieldForDateAndDropdowns(column)" #date="ngModel"
                    [required]="column.required"
                    [ngStyle]="{'background-color': !column.fieldError? 'white' : '#FD3A4A'}">
                  <div class="messages text-danger" *ngIf="(date.touched || submitted) && date.errors?.required">
                    Enter valid <label [innerHtml]="column.label"></label></div>
                </label>
                <label *ngIf="(column.type==='textarea')">
                  <textarea [name]='column.name' [(ngModel)]='column.value' #textarea="ngModel"
                    (ngModelChange)="fieldValidation(column)" [required]="column.required"
                    [ngStyle]="{'background-color': !column.fieldError? 'white' : '#FD3A4A'}"></textarea>
                  <div class="messages text-danger"
                    *ngIf="(textarea.touched || submitted) && textarea.errors?.required"> <label
                      [innerHtml]="column.label"></label> can't be blank</div>
                </label>

                <div *ngIf="(column.type==='select')">
                  <label *ngIf="!column.multiple">
                    <select class="select-table" [required]="column.required" [name]='column.name'
                      (ngModelChange)="onChangeFieldForDateAndDropdowns(column)" [(ngModel)]='column.value'
                      #select="ngModel">
                      <option *ngFor='let optionList of column.values' [value]="optionList.value"
                        [ngStyle]="{'background-color': !column.fieldError? 'white' : '#FD3A4A'}">
                        {{optionList.label}}
                      </option>
                    </select>
                    <div class="messages text-danger" *ngIf="(select.touched || submitted) && select.errors?.required">
                      <label [innerHtml]="column.label"></label> can't be blank
                    </div>

                  </label>
                  <div style="width: 400px;" *ngIf="column.multiple">
                    <textarea class="multiple-textarea" [rows]="(column.value.length/50)+1"
                      [innerHtml]="column.value"></textarea>

                  </div>
                </div>
                <label *ngIf="(column.type==='checkbox-group')">
                  <div *ngFor="let cheboxvalue of row.column.values ; let lengthIndex=index;">
                    <label>
                      <input type="checkbox" [name]='column.name' [checked]="cheboxvalue.selected"
                        (change)="cheboxvalue.selected=!cheboxvalue.selected;setCheckBoxValidation(column);onChangeFieldForDateAndDropdowns(column)"
                        [ngStyle]="{'background-color': !column.fieldError? 'white' : '#FD3A4A'}">
                      {{cheboxvalue.label}}
                    </label>
                    <div class="messages text-danger"
                      *ngIf="(!column.checkBoxValidationFlag) && submitted && column.required && lengthIndex== (column.values.length-1)">
                      <label [for]="column.name" [innerHtml]="column.label"></label> can't be blank
                    </div>
                  </div>
                </label>
                <label *ngIf="(column.type==='radio-group')">
                  <div *ngFor="let radioButtonValue of row.column.values">
                    <label>
                      <input class="default-radio" type="checkbox" [name]='column.name'
                        [checked]="radioButtonValue.selected"
                        (change)="setCheckedAsRadioColumn(column.values,column.name,radioButtonValue.value);onChangeFieldForDateAndDropdowns(column)"
                        [ngStyle]="{'background-color': !column.fieldError? 'white' : '#FD3A4A'}">
                      {{radioButtonValue.label}}
                    </label>
                  </div>
                </label>
                <label *ngIf="(column.type==='datetime-local')">
                  <input type="datetime-local" [name]='column.name'
                    (ngModelChange)="onChangeFieldForDateAndDropdowns(column)" [(ngModel)]='column.value'
                    [required]="column.required" #dateTime="ngModel"
                    [ngStyle]="{'background-color': !column.fieldError? 'white' : '#FD3A4A'}">
                  <div class="messages text-danger"
                    *ngIf="(dateTime.touched || submitted) && dateTime.errors?.required">Enter valid <label
                      [innerHtml]="column.label"></label></div>
                </label>
                <label *ngIf="(column.type==='time')">
                  <input type="time" [name]='column.name' (ngModelChange)="onChangeFieldForDateAndDropdowns(column)"
                    [ngStyle]="{'background-color':!column.fieldError? 'white' : '#FD3A4A'}" [(ngModel)]='column.value'
                    [required]="column.required" #time="ngModel">
                  <div class="messages text-danger" *ngIf="(time.touched || submitted) && time.errors?.required">
                    Enter valid <label [innerHtml]="column.label"></label></div>
                </label>
                <label class="form-group row" *ngIf="(column.type==='file')">
                  <input style="margin-left: 1rem;" type="text" [name]='column.name' [(ngModel)]='column.value'
                    (ngModelChange)="onChangeFileName(column)"
                    [ngStyle]="{'background-color':!column.fieldError? 'white' : '#FD3A4A'}">
                  <div class="messages text-danger" *ngIf="column.fieldError">
                    {{column.errorMessage}}</div>
                </label>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <div style="text-align: center" class="messages text-danger" *ngIf="this.enableImportButton">Please Fill all the
        Data
      </div>
      <br>
    </ng-container>
  </div>
  <div class="app-modal-footer">
    <button type="button" class="btn btn-sm btn-success waves-effect waves-light m-r-10"
      [disabled]="!permissionModal.createButtonFlag || this.enableImportButton" (click)="importData()">Import </button>
    <button type="button" class="btn btn-sm btn-danger waves-effect waves-light m-r-10"
      (click)="bulkEquipmentModal.hide(); closeBulkEquipmentModel()">Close</button>
  </div>
</app-modal-basic>