<div class="row" *ngIf="!isWorkFlowpage" style="height: 100px;">
  <div id="float-action" class="col-sm-12" style="margin-top: 10px;">
    <app-card>
      <div class="row">
        <div class="col-sm-6">
          <div class="page-header-title" *ngIf="!isProjectNameEdit">
            <i style="width: 30px;height: 30px;" class="icofont icofont-data bg-c-blue"></i>
            <div class="d-inline" style="padding-top: 4px;">
              <h4 (click)="onClickProjectname()">{{projectSetup.projectName}}</h4>
            </div>
          </div>
          <div *ngIf="isProjectNameEdit">
            <div class="row">
              <div class="col-sm-10">
                <input style="border:1px solid darkblue" class="form-control" type="text" name="projectName" [(ngModel)]="projectName"  maxlength="49" (ngModelChange)="showNext()">
                <div class="messages text-danger" *ngIf="this.validationMessage!=''">{{this.validationMessage}}</div>
              </div>
              <div class="col-sm-2" *ngIf="this.validationMessage === '' && this.projectName != ''">
                <a  href="javascript:" class="m-r-10"><img class="image-radius rounded-0 img-27 img-height"
                  src="assets/icon/png-icons/save.svg" alt="Update Project Name" placement="bottom" ngbTooltip="Update Project Name"
                  (click)="saveProjectName();"></a>
              </div>
            </div>
          </div>
        </div>
        <div class="col-sm-6" style="text-align: right;">
          
          <a role="button" *ngIf="isEnableWorkflow"><img class="image-radius rounded-0 img-30 float-right m-r-20"
            src="assets/icon/png-icons/esign.png" alt="Forum" placement="bottom" ngbTooltip="Approve"
            (click)="isWorkFlowpage=true"></a>

          <a role="button"><img class="image-radius rounded-0 img-30 float-right m-r-20"
            src="assets/icon/png-icons/workflow-new.png" alt="Forum" placement="bottom" ngbTooltip="Work Flow"
            (click)="onClickWorkflow();"></a>

            <a *ngIf="permissionModal.createButtonFlag && permissionModal.userInWorkFlow" href="javascript:" class="m-r-15"><img
              class="image-radius rounded-0 img-27" src="assets/icon/png-icons/addDoc.png" alt="Add URS"
              placement="bottom" ngbTooltip="Add URS" (click)="createUrsModal.show();onClickCreateUrs()"></a>
              
            <a *ngIf="permissionModal.userInWorkFlow"
                href="javascript:" class="m-r-15"><img class="image-radius rounded-0 img-25"
                  src="assets/icon/png-icons/updateOrder.png" alt="Update Order" placement="bottom"
                  ngbTooltip="Update Order" (click)="UrsCodeOrderModal.show();loadDataForOrder();"></a>
            <a *ngIf="permissionModal.createButtonFlag && permissionModal.userInWorkFlow" href="javascript:" class="m-r-15"><img
              class="image-radius rounded-0 img-25" src="assets/icon/png-icons/import.png"
              alt="Import URS" placement="bottom" ngbTooltip="Import URS"
              (click)="importUrsModal();"></a>

              
        </div>
      </div>
    </app-card>
  </div>
  <div class="col-sm-12">
    <br><br> <br>
  </div>
  <div class="col-sm-12" style="margin-top:5px">
    <div style="display: flex;overflow: auto;">
      <div *ngFor="let category of data">
        <div class="card list-wrapper">
          <div class="card-block list">
            <div class="row">
              <div class="col-sm-10">
                <h4 class="card-title">{{category.categoryName}}</h4>
              </div>
              <div class="col-sm-2" *ngIf="category.categoryName === 'Draft (Backlogs)'">
                <a href="javascript:">
                  <img style="margin-top: -17px;" class="image-radius rounded-0 img-25"
                  src="assets/icon/png-icons/published.png" alt="Publish" placement="bottom" ngbTooltip="Publish All"
                  (click)="publishData()">
                </a>
                <!-- <div class="datatable-checkbox">
                  <div class="checkbox-fade fade-in-primary card-title-padding" style="width: 330px;">
                      <label>
                          <input type="checkbox" [checked]="category.selectAll"
                          (click)="selectAllData($event,category.ursList)"/>
                          <span class="cr"><i class="cr-icon icofont icofont-ui-check txt-primary" title="Select All"></i></span>
                      </label>
                  </div>
              </div> -->
              </div>
            </div>
            <div class="list-cards" [ngStyle]="{'max-height':windowHeight.innerHeight-250+'px'}">
              <div class="card-margin" *ngFor="let urs of category.ursList">
                <expansion-panels-container>
                  <expansion-panel>
                    <expansion-panel-title style="width: 340px;">
                      <span style="text-overflow: ellipsis;
                      display: -webkit-box;
                      -webkit-line-clamp: 2;
                      overflow: hidden !important;
                      -webkit-box-orient: vertical;">
                        <span [ngStyle]="{'color': urs.priorityColor}"><i class="fa fa-circle"></i></span> {{urs.ursCode}} : <span class="font-13">{{urs.requirement}}</span>
                      </span>
                        <hr class="horzontal_line">
                        <span class="font-13">
                          <span *ngIf="urs.status !='Draft'"><strong>URS Status</strong> : {{urs.status}}</span>
                          <span *ngIf="urs.status ==='Draft'"><strong>Category</strong> : {{urs.categoryname}}</span>
                         <span *ngIf="urs.checkListstatusCount !=''"> |
                          <strong>checklist</strong> : {{urs.checkListstatusCount}}
                        </span> 
                        </span>
                        <hr class="horzontal_line">
                        <span class="font-13">
                          <strong [ngStyle]="{'color': urs.testingRequiredColor}">Testing Required</strong> : 
                          <span [ngStyle]="{'color': urs.testingRequiredColor}">{{urs.testingRequiredText}}</span>
                          | 
                          <span><strong>Testing Method</strong> : {{urs.testingMethod?urs.testingMethod:'N/A'}}</span>
                        </span>
                        <hr class="horzontal_line">
                        <span class="font-13" *ngIf="urs.testCasePublishCount > 0">
                          <div class="row">
                            <div class="col-sm-6">
                              <span><strong>Testing Status : </strong>{{urs.testCaseCompletedCount}}/ {{urs.testCasePublishCount}}</span>
                            </div>
                            <div class="col-sm-6">
                              <span>
                                <a  class="m-r-15 font-size-9px">
                                  {{calculatePercentage(urs.testCasePublishCount, urs.testCaseCompletedCount)}}%
                                </a>
                                <a class="progress w-15" style="height: 0.5em !important;width: 50%;">
                                    <a class={{this.progressBarColour}} role="progressbar" aria-valuenow=this.percentage
                                        aria-valuemin="0" aria-valuemax="100" [style.width]="this.percentage + '%'">
                                    </a>
                                  </a>
                              </span>
                            </div>
                          </div>
                          </span>
                        <!-- <hr class="horzontal_line">
                        <span class="font-13">
                          <span *ngIf="spWorkFlowPer">Spec : {{urs.specCount}} |</span> 
                          <span *ngIf="riskWorkFlowPer">Risk : {{urs.riskCount}} | </span>
                          <span *ngIf="testcaseWorkFlowPer">Test Case : {{urs.testCaseCount}} | </span>
                          <span *ngIf="urs.adHocCount > 0">Unscripted : {{urs.adHocCount}}</span>
                        </span> -->
                      </expansion-panel-title>
                    <expansion-panel-content>
                      <div class="content-margin">
                        {{urs.description}}
                      </div>
                      <!-- <div class="content-margin">Spec : {{urs.specCount}} | Risk : {{urs.riskCount}} | Test Case :
                        {{urs.testCaseCount}} | Unscripted : {{urs.adHocCount}}</div> -->
                      <div>
                        <a href="javascript:void(0)" class="m-r-10"
                          (click)="detailedView.show();loadDetailedView(urs)">View more</a>

                          <a *ngIf="permissionModal.publishButtonFlag && urs.status ==='Draft' && !isWorkflowDocumentOrderSequence"
                            href="javascript:" class="m-l-20">
                            <img class="image-radius rounded-0 img-25" style="padding-bottom: 8px;" src="assets/icon/png-icons/published.png"
                              alt="Publish" placement="top" ngbTooltip="Publish" (click)="singlepublishData(urs)">
                          </a>
                          <a container="body" *ngIf="permissionModal.updateButtonFlag && urs.status ==='Draft'" href="javascript:;"
                            (click)="urlRedirection(urs)"
                            class="m-l-20 crm-action-edit text-muted text-primary" placement="top" ngbTooltip="Edit">
                            <i style="font-size: 20px;" class="icofont icofont-edit edit"></i>
                          </a>
                        <a container="body" href="javascript:;" (click)="onClickSP(urs.id)"
                          *ngIf="specification.createButtonFlag && spWorkFlowPer && urs.publishedflag"
                          class="m-r-15 crm-action-edit text-muted text-primary" placement="top"
                          ngbTooltip="Add Specification">
                          <i class="text-nav-color icofont icofont-login"></i></a>

                        <a container="body" href="javascript:;" (click)="onClickRisk(urs.id)"
                          *ngIf="riskPermission.createButtonFlag && riskWorkFlowPer && urs.publishedflag"
                          class="m-r-15 crm-action-edit text-muted text-primary" placement="top" ngbTooltip="Add Risk">
                          <i class="text-black icofont icofont-login"></i></a>

                        <a container="body" href="javascript:;" (click)="onClickTestCases(urs.id)"
                          *ngIf="testCase.createButtonFlag && testcaseWorkFlowPer && isTestcaseModulePermission && urs.status!='Draft'"
                          class="m-r-15 crm-action-edit text-muted text-primary" placement="top"
                          ngbTooltip="Add Testcases">
                          <i class="text-success icofont icofont-login"></i></a>

                        <a container="body" href="javascript:;" (click)="onClickAdHoc(urs.id)"
                          *ngIf="adHocPermission.createButtonFlag && urs.publishedflag"
                          class="m-r-15 crm-action-edit text-muted text-primary" placement="top"
                          ngbTooltip="Add Unscripted Testing">
                          <i class="text-warning icofont icofont-login"></i></a>
                      </div>
                    </expansion-panel-content>
                  </expansion-panel>
                </expansion-panels-container>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="row" *ngIf="isWorkFlowpage">
  <div class="col-sm-12">
    <app-individual-document-workflow [permissionConstant]="this.helper.URS_VALUE"
    (onClose)="isWorkFlowpage=false; this.loadData();this.loadDocuments();">
  </app-individual-document-workflow>
  </div>
</div>

<div *ngIf="spinnerFlag" class="loading">Loading&#8230;</div>

<app-modal-basic #detailedView [dialogClass]="'modal-lg'" class="modal-dialog modal-dialog-scrollable">
  <div class="app-modal-header" *ngIf="detailedViewData">

    <h5 style="text-transform: none;"><span [ngStyle]="{'color': detailedViewData.priorityColor}"><i
          class="fa fa-circle"></i></span> {{detailedViewData.ursCode}}</h5>

    <div class="float-right">
      <a container="body" href="javascript:;" (click)="onClickSP(detailedViewData.id)"
        *ngIf="specification.createButtonFlag && spWorkFlowPer && detailedViewData.publishedflag"
        class="m-r-15 crm-action-edit text-muted text-primary" placement="top" ngbTooltip="Add Specification">
        <i class="text-nav-color icofont icofont-login"></i></a>

      <a container="body" href="javascript:;" (click)="onClickRisk(detailedViewData.id)"
        *ngIf="riskPermission.createButtonFlag && riskWorkFlowPer && detailedViewData.publishedflag"
        class="m-r-15 crm-action-edit text-muted text-primary" placement="top" ngbTooltip="Add Risk">
        <i class="text-black icofont icofont-login"></i></a>

      <a container="body" href="javascript:;" (click)="onClickTestCases(detailedViewData.id)"
        *ngIf="testCase.createButtonFlag && testcaseWorkFlowPer && isTestcaseModulePermission && detailedViewData.status!='Draft'"
        class="m-r-15 crm-action-edit text-muted text-primary" placement="top" ngbTooltip="Add Testcases">
        <i class="text-success icofont icofont-login"></i></a>

      <a container="body" href="javascript:;" (click)="onClickAdHoc(detailedViewData.id)"
        *ngIf="adHocPermission.createButtonFlag && detailedViewData.publishedflag"
        class="m-r-15 crm-action-edit text-muted text-primary" placement="top" ngbTooltip="Add Unscripted Testing">
        <i class="text-warning icofont icofont-login"></i></a>
    </div>
    <button type="button" class="close basic-close" (click)="detailedView.hide();onCloseDetailedView();">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="app-modal-body">
    <div class="row">
      <div class="col-sm-12">
        <div style="padding-bottom:10px;"><strong>Requirement</strong> : {{detailedViewData.requirement}}</div>
        <div style="padding-bottom:10px;"><strong>Description</strong> : {{detailedViewData.description}}</div>
        <div style="padding-bottom:10px;"><strong>Priority</strong> : <span
            [ngStyle]="{'color': detailedViewData.priorityColor}">{{detailedViewData.priorityName}}</span></div>
        <div><strong>Status</strong> : {{detailedViewData.status}}</div>
        <div><strong>Compliance Requirement : </strong><span class="text-c-blue" style="cursor: pointer"><u (click)="onClickCompliances(detailedViewData);">Click Here to Select{{detailedViewData.complianceRequirements && detailedViewData.complianceRequirements.length > 0?'('+detailedViewData.complianceRequirements.length+' items selected)':''}}</u></span></div>
        
        <div *ngIf="detailedViewData.checklist && detailedViewData.checklist.length > 0">
					<div  style="padding-top:10px;"><strong>Checklist : </strong></div>
					<table id="urs-table-checkList" class="table">
					  <thead class="panel-heading">
						<tr class="w-100">
						  <td style="width: 1%;"><label class="strong">Status</label></td>
						  <td class="w-40"><label class="strong">Name</label></td>
						  <td style="width: 5%;"><label class="strong">Action Taken</label></td>
						</tr>
					  </thead>
					  <tbody class="panel-body">
						<ng-container *ngFor="let checkList of detailedViewData.checklist; let i = index">
						  <tr>
							<td>
								<div class="checkbox-fade fade-in-primary">
									<label>
										<input type="checkbox" [(ngModel)]="checkList.completed" [ngModelOptions]="{standalone: true}" (change)="onChangeStatus(checkList)" />
										<span class="cr"><i class="cr-icon icofont icofont-ui-check txt-primary"></i></span>
									  </label>
								</div>
							  </td>
							<td style=" white-space: initial;">
							  <span [style.text-decoration]="checkList.completed ? 'line-through' : 'none'">{{checkList.checklistName}}</span>
							</td>
							<td>
								<span >{{checkList.updatedBy}}<span *ngIf="checkList.updatedBy!=''">/</span>{{checkList.displayUpdatedTime}}</span>
							  </td>
						  </tr>
						</ng-container>
					  </tbody>
					</table>
				  </div>
        <div>
          <div class="card-margin">
            <expansion-panels-container>
              <expansion-panel #specPanel (onOpen)='loadSpecDetails(detailedViewData.id)'>
                <expansion-panel-title>
                  <div class="row">
                    <div class="col-sm-6">
                      Specification : {{detailedViewData.specCount}}
                    </div>
                    <div class="col-sm-6">
                      <span>
                        <a  class="m-r-15 font-size-9px">
                          {{specCalculatePercentage(detailedViewData.specPublishCount, detailedViewData.specCompletedCount)}}%
                        </a>
                        <a class="progress w-15" style="height: 0.5em !important;width: 50%;">
                            <a class={{this.specProgressBarColour}} role="progressbar" aria-valuenow=this.specPercentage
                                aria-valuemin="0" aria-valuemax="100" [style.width]="this.specPercentage + '%'">
                            </a>
                          </a>
                      </span>
                    </div>
                  </div>
                </expansion-panel-title>
                <expansion-panel-content>
                  <div class="row" class="content-margin">
                    <div class="col-sm-12">
                      <ngx-datatable [scrollbarH]="true" #myTable class="data-table dt-chk"
                        style="overflow: unset!important;" [rows]='specList' [limit]="5" [columnMode]="'force'"
                        [headerHeight]="50" [footerHeight]="50" [rowHeight]="'auto'">

                        <ngx-datatable-column style="font-weight: bold;" name="Spec Id">
                          <ng-template let-row="row" let-expanded="expanded" ngx-datatable-cell-template>
                            <a href="javascript:;" (click)="navigateToChild(this.helper.SP_VALUE,row)" class="btn btn-link p-0">
                              <strong>{{row['spCode']}}</strong>
                            </a>
                          </ng-template>
                        </ngx-datatable-column>

                        <ngx-datatable-column style="font-weight: bold;" name="Type">
                          <ng-template let-row="row" let-expanded="expanded" ngx-datatable-cell-template>
                            <strong>{{row['spTypeValue']}}</strong>
                          </ng-template>
                        </ngx-datatable-column>

                        <ngx-datatable-column style="font-weight: bold;" name="Spec Description">
                          <ng-template let-row="row" let-expanded="expanded" ngx-datatable-cell-template> 
                            <strong style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">{{row['spDescription']}}</strong>
                          </ng-template>
                        </ngx-datatable-column>

                        <ngx-datatable-column name="Document Status">
                          <ng-template let-row="row" ngx-datatable-cell-template>
                            <strong style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">{{row['status']}}</strong>
                          </ng-template>
                        </ngx-datatable-column>
                      </ngx-datatable>
                    </div>
                  </div>
                </expansion-panel-content>
              </expansion-panel>
            </expansion-panels-container>
          </div>
          <div class="card-margin">
            <expansion-panels-container>
              <expansion-panel #riskPanel (onOpen)='loadRiskDetails(detailedViewData.id)'>
                <expansion-panel-title>
                  <div class="row">
                    <div class="col-sm-6">
                      Risk Assessment : {{detailedViewData.riskCount}}
                    </div>
                    <div class="col-sm-6">
                      <span>
                        <a  class="m-r-15 font-size-9px">
                          {{riskCalculatePercentage(detailedViewData.riskPublishCount, detailedViewData.riskCompletedCount)}}%
                        </a>
                        <a class="progress w-15" style="height: 0.5em !important;width: 50%;">
                            <a class={{this.specProgressBarColour}} role="progressbar" aria-valuenow=this.riskPercentage
                                aria-valuemin="0" aria-valuemax="100" [style.width]="this.riskPercentage + '%'">
                            </a>
                          </a>
                      </span>
                    </div>
                  </div>
                </expansion-panel-title>
                <expansion-panel-content>
                  <div class="row" class="content-margin">
                    <div class="col-sm-12">
                      <ngx-datatable [scrollbarH]="true" #myTable class="data-table dt-chk"
                        style="overflow: unset!important;" [rows]='riskList' [limit]="5" [columnMode]="'force'"
                        [headerHeight]="50" [footerHeight]="50" [rowHeight]="'auto'">
                        <ngx-datatable-column style="font-weight: bold;" name="Risk Id">
                          <ng-template let-row="row" let-expanded="expanded" ngx-datatable-cell-template>
                            <a href="javascript:;" (click)="navigateToChild(this.helper.RISK_ASSESSMENT_VALUE,row)" class="btn btn-link p-0">
                              <strong>{{row['assessmentCode']}}</strong>
                            </a>
                          </ng-template>
                        </ngx-datatable-column>

                        <ngx-datatable-column style="font-weight: bold;" name="Risk Factor">
                          <ng-template let-row="row" let-expanded="expanded" ngx-datatable-cell-template> 
                            <strong style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">{{row['riskFactor']}}</strong>
                          </ng-template>
                        </ngx-datatable-column>

                        <ngx-datatable-column name="Severity">
                          <ng-template let-row="row" ngx-datatable-cell-template>
                            <strong style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">{{row['severityName']}}</strong>
                          </ng-template>
                        </ngx-datatable-column>

                        <ngx-datatable-column name="Probability">
                          <ng-template let-row="row" ngx-datatable-cell-template>
                            <strong style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">{{row['probabilityOfOccuranceName']}}</strong>
                          </ng-template>
                        </ngx-datatable-column>

                        <ngx-datatable-column name="Detectability">
                          <ng-template let-row="row" ngx-datatable-cell-template>
                            <strong style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">{{row['detectabilityName']}}</strong>
                          </ng-template>
                        </ngx-datatable-column>

                        <ngx-datatable-column name="RPN">
                          <ng-template let-row="row" ngx-datatable-cell-template>
                            <strong style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">{{row['rpn']}}</strong>
                          </ng-template>
                        </ngx-datatable-column>

                        <ngx-datatable-column name="Criticality">
                          <ng-template let-row="row" ngx-datatable-cell-template>
                            <strong style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">{{row['critical']}}</strong>
                          </ng-template>
                        </ngx-datatable-column>

                        <ngx-datatable-column name="Priority">
                          <ng-template let-row="row" ngx-datatable-cell-template>
                            <strong style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">{{row['priorityName']}}</strong>
                          </ng-template>
                        </ngx-datatable-column>
                        <ngx-datatable-column name="Residual Severity">
                          <ng-template let-row="row" ngx-datatable-cell-template>
                            <strong style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">{{row['residualServerityName']}}</strong>
                          </ng-template>
                        </ngx-datatable-column>

                        <ngx-datatable-column name="Residual Probability">
                          <ng-template let-row="row" ngx-datatable-cell-template>
                            <strong style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">{{row['residualProbabilityName']}}</strong>
                          </ng-template>
                        </ngx-datatable-column>

                        <ngx-datatable-column name="Residual Detectability">
                          <ng-template let-row="row" ngx-datatable-cell-template>
                            <strong style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">{{row['residualDetetablityName']}}</strong>
                          </ng-template>
                        </ngx-datatable-column>

                        <ngx-datatable-column name="Residual RPN">
                          <ng-template let-row="row" ngx-datatable-cell-template>
                            <strong style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">{{row['residualRpn']}}</strong>
                          </ng-template>
                        </ngx-datatable-column>
                        <ngx-datatable-column name="Residual Priority">
                          <ng-template let-row="row" ngx-datatable-cell-template>
                            <strong style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">{{row['residualPriorityName']}}</strong>
                          </ng-template>
                        </ngx-datatable-column>
                        <ngx-datatable-column name="Conclusion">
                          <ng-template let-row="row" ngx-datatable-cell-template>
                            <strong style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">{{row['residualConclusion']}}</strong>
                          </ng-template>
                        </ngx-datatable-column>

                       
                        <ngx-datatable-column name="Document Status">
                          <ng-template let-row="row" ngx-datatable-cell-template>
                            <strong style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">{{row['status']}}</strong>
                          </ng-template>
                        </ngx-datatable-column>
                      </ngx-datatable>
                    </div>
                  </div>
                </expansion-panel-content>
              </expansion-panel>
            </expansion-panels-container>
          </div>
          <div class="card-margin">
            <expansion-panels-container>
              <expansion-panel #testcasePanel (onOpen)='loadTestcaseDetails(detailedViewData.id)'>
                <expansion-panel-title>
                  <div class="row">
                    <div class="col-sm-6">
                      Test Case : {{detailedViewData.testCaseCount}} 
                    </div>
                    <div class="col-sm-6">
                      <span>
                        <a  class="m-r-15 font-size-9px">
                          {{calculatePercentage(detailedViewData.testCasePublishCount, detailedViewData.testCaseCompletedCount)}}%
                        </a>
                        <a class="progress w-15" style="height: 0.5em !important;width: 50%;">
                            <a class={{this.progressBarColour}} role="progressbar" aria-valuenow=this.percentage
                                aria-valuemin="0" aria-valuemax="100" [style.width]="this.percentage + '%'">
                            </a>
                          </a>
                      </span>
                    </div>
                  </div>
                </expansion-panel-title>
                <expansion-panel-content>
                  <div class="row" class="content-margin">
                    <div class="col-sm-12">
                      <ngx-datatable [scrollbarH]="true" #myTable class="data-table dt-chk"
                        style="overflow: unset!important;" [rows]='testCasesList' [limit]="5" [columnMode]="'force'"
                        [headerHeight]="50" [footerHeight]="50" [rowHeight]="'auto'">

                        <ngx-datatable-column style="font-weight: bold;" name="Test Id">
                          <ng-template let-row="row" let-expanded="expanded" ngx-datatable-cell-template>
                            <a href="javascript:;" (click)="navigateToChild(this.helper.TEST_CASE_CREATION_VALUE,row)" class="btn btn-link p-0">
                              <strong>{{row['testCaseCode']}}</strong>
                            </a>
                          </ng-template>
                        </ngx-datatable-column>

                        <ngx-datatable-column style="font-weight: bold;" name="Test Run Name">
                          <ng-template let-row="row" let-expanded="expanded" ngx-datatable-cell-template>
                            <strong style="font-weight: normal;">{{row['testRunName']}}</strong>
                          </ng-template>
                        </ngx-datatable-column>

                        <ngx-datatable-column style="font-weight: bold;" name="Test Description">
                          <ng-template let-row="row" let-expanded="expanded" ngx-datatable-cell-template> 
                            <strong style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">{{row['description']}}</strong>
                          </ng-template>
                        </ngx-datatable-column>

                        <ngx-datatable-column name="Document Status">
                          <ng-template let-row="row" ngx-datatable-cell-template> 
                            <strong style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">{{row['approvedStatus']}}</strong>
                          </ng-template>
                        </ngx-datatable-column>

                        <ngx-datatable-column name="Expected Result">
                          <ng-template let-row="row" ngx-datatable-cell-template> 
                            <strong style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">{{row['expectedResult']}}</strong>
                          </ng-template>
                        </ngx-datatable-column>

                        <ngx-datatable-column name="Actual Result">
                          <ng-template let-row="row" ngx-datatable-cell-template> 
                            <strong style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">{{row['actualResult']}}</strong>
                          </ng-template>
                        </ngx-datatable-column>

                        <ngx-datatable-column name="Status">
                          <ng-template let-row="row" ngx-datatable-cell-template>
                            <strong style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">{{row['status']}}</strong>
                          </ng-template>
                        </ngx-datatable-column>
                      </ngx-datatable>
                    </div>
                  </div>
                </expansion-panel-content>
              </expansion-panel>
            </expansion-panels-container>
          </div>
          <div class="card-margin">
            <expansion-panels-container>
              <expansion-panel #adHocPanel (onOpen)='loadAdHocDetails(detailedViewData.id)'>
                <expansion-panel-title>
                  <div class="row">
                    <div class="col-sm-6">
                      Unscripted : {{detailedViewData.adHocCount}}
                    </div>
                    <div class="col-sm-6">
                      <span>
                        <a  class="m-r-15 font-size-9px">
                          {{unscriptedCalculatePercentage(detailedViewData.unscriptedPublishCount, detailedViewData.unscriptedCompletedCount)}}%
                        </a>
                        <a class="progress w-15" style="height: 0.5em !important;width: 50%;">
                            <a class={{this.unscriptedProgressBarColour}} role="progressbar" aria-valuenow=this.unscriptedPercentage
                                aria-valuemin="0" aria-valuemax="100" [style.width]="this.unscriptedPercentage + '%'">
                            </a>
                          </a>
                      </span>
                    </div>
                  </div>
                  
                </expansion-panel-title>
                <expansion-panel-content>
                  <div class="row" class="content-margin">
                    <div class="col-sm-12">
                      <ngx-datatable [scrollbarH]="true" #myTable class="data-table dt-chk"
                        style="overflow: unset!important;" [rows]='adHocList' [limit]="5" [columnMode]="'force'"
                        [headerHeight]="50" [footerHeight]="50" [rowHeight]="'auto'">

                        <ngx-datatable-column style="font-weight: bold;" name="Unscripted Testing Id">
                          <ng-template let-row="row" let-expanded="expanded" ngx-datatable-cell-template>
                            <a href="javascript:;" (click)="navigateToChild(this.helper.Unscripted_Value,row)" class="btn btn-link p-0">
                              <strong>{{row['testCaseCode']}}</strong>
                            </a>
                          </ng-template>
                        </ngx-datatable-column>

                        <ngx-datatable-column style="font-weight: bold;" name="Test Description">
                          <ng-template let-row="row" let-expanded="expanded" ngx-datatable-cell-template>
                            <strong style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">{{row['description']}}</strong>
                          </ng-template>
                        </ngx-datatable-column>

                        <ngx-datatable-column style="font-weight: bold;" name="Test Result">
                          <ng-template let-row="row" let-expanded="expanded" ngx-datatable-cell-template>
                            <strong style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">{{row['expectedResult']}}</strong>
                          </ng-template>
                        </ngx-datatable-column>

                        <ngx-datatable-column name="Status">
                          <ng-template let-row="row" ngx-datatable-cell-template>
                            <strong style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">{{row['status']}}</strong>
                          </ng-template>
                        </ngx-datatable-column>

                        <ngx-datatable-column name="Business Impact">
                          <ng-template let-row="row" ngx-datatable-cell-template>
                            <strong style="font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: normal;">{{row['businessImpact']}}</strong>
                          </ng-template>
                        </ngx-datatable-column>
                      </ngx-datatable>
                    </div>
                  </div>
                </expansion-panel-content>
              </expansion-panel>
            </expansion-panels-container>
          </div>
        </div>
      </div>
      <div *ngIf="spinnerFlag" class="loading">Loading&#8230;</div>
    </div>
  </div>
</app-modal-basic>

<app-modal-basic #createUrsModal [dialogClass]="'modal-lg'" class="modal-dialog modal-dialog-scrollable">
  <div class="app-modal-header">
		<h4 class="modal-title">Create URS</h4>
		<div style="position: absolute;top: 20px;right: 10px;">
			<button type="button" class="btn btn-sm btn-success" (click)="saveAndGoto(urs.valid);">Save</button>
			<button type="button" class="btn btn-sm btn-danger" (click)="createUrsModal.hide();">Cancel</button>
    </div>
  </div>
  <div class="app-modal-body">
    <form #urs="ngForm">
      <table id="add-table" class="table w-100">
        <tbody>
          <tr>
            <td>
              <div class="row">
                <div class="col-sm-3">
                  <strong class="strong">Requirement<span class="asterisk required">*</span> :</strong>
                </div>
                <div class="col-sm-9">
                  <textarea autofocus="autofocus" type="text" id="requirement" class="form-control max-textarea" [(ngModel)]="modal.ursName" name="ursName"
                    #ursName="ngModel" placeholder="URS Name" maxlength="250" required></textarea>
                  <div class="messages text-danger"
                    *ngIf="ursName.touched && submitted && ursName.errors?.required">Requirement can't be blank</div>
                </div>
              </div>
            </td>

            <td>
              <div class="row">
                <div class="col-sm-3">
                  <strong class="strong">Description :</strong>
                </div>
                <div class="col-sm-9">
                  <ui-switch (click)="editorSwap=!editorSwap" [checked]="editorSwap" class="js-small" color="#3498DB"
                    switchColor="#fff" size="small" unchecked>
                  </ui-switch>&nbsp;
                  <label class="text-success" *ngIf="!editorSwap">Enable Advance Editor</label>
                  <label class="text-danger" *ngIf="editorSwap">Disable Advance Editor</label>
                  <div *ngIf="editorSwap">
                    <quill-editor [(ngModel)]="modal.description" [options]="this.helper.editQuillOptions"
                      (ready)="onEditorCreated($event)" name="description"> </quill-editor>
                  </div>
                  <textarea *ngIf="!editorSwap" class="form-control max-textarea" [(ngModel)]="modal.description" name="street"></textarea>
                </div>
              </div>
            </td>
          </tr>

          <tr>
            <td>
              <div class="row">
                <div class="col-sm-3">
                  <strong class="strong">Category<span class="asterisk required">*</span> :</strong>
                </div>
                <div class="col-sm-9">
                  <select #categoryName="ngModel" [(ngModel)]="modal.category" name="categoryName"
                    class="form-control">
                    <option value=0 disabled>Select Category</option>
                    <option *ngFor="let category of categoryList" [value]="category.id">{{category.categoryName}}
                    </option>
                  </select>
                  <div class="messages text-danger" *ngIf="categoryName.touched && submitted && modal.category==0">Please select the category</div>
                </div>
              </div>
            </td>

            <td>
              <div class="row">
                <div class="col-sm-3">
                  <strong class="strong">Priority<span class="asterisk required">*</span> :</strong>
                </div>
                <div class="col-sm-9">
                  <select #priority="ngModel" [(ngModel)]="modal.priority" name="priority"
                    (change)="selectOption($event.target.value)" class="form-control"
                    [ngStyle]="{'background-color': this.returnColor}">
                    <option value=0>Select Priority</option>
                    <option *ngFor="let priority of priorityList" [value]="priority.id">{{priority.priorityName}}
                    </option>
                  </select>
                  <div class="messages text-danger" *ngIf="priority.touched && submitted && modal.priority==0">Please select the priority</div>
                </div>
              </div>
            </td>
          </tr>
          <tr>
            <td>
              <div class="row">
                <div class="col-sm-3">
                  <strong class="strong">Potential risk on failure :</strong>
                </div>
                <div class="col-sm-9">
                  <select [(ngModel)]="modal.potentialRisk" name="potentialRisk"
                    (change)="onChangePotentialAndImplemenation()" class="form-control">
                    <option value="">Select Potential Risk</option>
                    <option *ngFor="let item of potentialList" [value]="item.key">{{item.value}}
                    </option>
                  </select>
                </div>
              </div>
            </td>
            <td>
              <div class="row">
                <div class="col-sm-3">
                  <strong class="strong">Testing Required:</strong>
                </div>
                <div class="col-sm-9">
                <ui-switch (change)="modal.testingRequired=!modal.testingRequired; onTestingRequired();" [checked]="modal.testingRequired"
                  class="js-small" color="#3498DB" switchColor="#fff" size="small">
                </ui-switch>
                </div>
              </div>
            </td>
          </tr>
          <tr *ngIf="this.modal.testingRequired">
            <td>
              <div class="row">
                <div class="col-sm-3">
                  <strong class="strong">Implementation Method :</strong>
                </div>
                <div class="col-sm-9">
                  <select [(ngModel)]="modal.implementationMethod" name="implementationMethod"
                    (change)="onChangePotentialAndImplemenation()" class="form-control">
                    <option value="">Select Implementation Method</option>
                    <option *ngFor="let item of implemenationList" [value]="item.key">{{item.value}}
                    </option>
                  </select>
                </div>
                </div>
            </td>
            <td>
              <div class="row">
                <div class="col-sm-3">
                  <strong class="strong">Testing Method :</strong>
                </div>
                <div class="col-sm-9">
                  <select [(ngModel)]="modal.testingMethod" name="testingMethod"
                    class="form-control">
                    <option *ngFor="let item of testingMethodList" [value]="item.key">{{item.value}}
                    </option>
                  </select>
                </div>
              </div>
            </td>
          </tr>
          <tr>
            <td>
              <div class="row">
                <div class="col-sm-3">
                  <strong class="strong">Compliance Requirement :</strong>
                </div>
                <div class="col-sm-9">
                  <span class="text-c-blue" style="cursor: pointer"><u (click)="onClickCompliance();">Click Here to Select{{this.modal.complianceRequirements.length > 0?'('+this.modal.complianceRequirements.length+' items selected)':''}}</u></span>
                </div>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
      <div>
        <div class="form-group row">
          <span class="p-l-20"><i class="icofont icofont-checked"></i> Check List</span>
        </div>
        <div class="form-group row" *ngIf="modal.checklist && modal.checklist.length==0">
          <div class="col-sm-4"></div>
          <div class="col-sm-4">
            <button type="button" class="btn btn-primary btn-sm" (click)="this.addChecklistItem();">
              <i class="icofont icofont-checked"></i>Add
            </button>
          </div>
          <div class="col-sm-4"></div>
        </div>
        <ng-container *ngIf="modal.checklist.length>0">
          <div class="col-sm-12">
            <table id="equipment-table-checkList" class="table">
              <thead class="panel-heading">
                <tr class="w-100">
                  <td style="width: 1%;"><label class="strong">S No.</label></td>
                  <td class="w-40"><label class="strong">Name</label></td>
                  <td class="w-10"><label class="strong">Actions</label></td>
                </tr>
              </thead>
              <tbody class="panel-body">
                <ng-container *ngFor="let checkList of modal.checklist; let i = index">
                  <tr>
                    <td>
                      <label placement="top" triggers="mouseenter:mouseleave" ngbTooltip="Display Order">{{i+1}} </label>
                    </td>
                    <td>
                      <input type="text" id="check_list_name_id_{{i}}" class="form-control" [(ngModel)]="checkList.checklistName"
                        (ngModelChange)="onChangecheckList()" [ngModelOptions]="{standalone: true}" />
                    </td>
                    <td>
                      <a class="pointer" role="button" title="Add" (click)="addChecklistItem(checkList);">
                        <i class="icofont icofont-ui-add text-success"></i></a>
                      <a class="pointer" role="button" title="Delete"
                        (click)="deleteCheckList(checkList);onChangecheckList()">
                        <i class="icofont icofont-ui-delete text-danger"></i></a>
                    </td>
                  </tr>
                </ng-container>
              </tbody>
            </table>
          </div>
        </ng-container>
      </div>
      <div style="color: red;" *ngIf="isCheckListEntered">Please Fill the Details to Continue . . .</div>
    </form>
    <div *ngIf="ursSpinnerFlag" class="loading">Loading&#8230;</div>
  </div>
</app-modal-basic>
<app-import-urs #importUrs [inputProjectId]="this.projectId" (onClose)="onCloseImportUrsModal()"></app-import-urs>
<app-add-document-workflow #addDocumentWorkFlow [projectId]="this.projectId" [permissionConstant]="this.helper.URS_VALUE"  (onClose)="onCloseAddWorkflowModal()"></app-add-document-workflow>
<app-modal-basic id="modal-lg-60" #UrsCodeOrderModal [hideHeader]="false" [hideFooter]="false"
	[dialogClass]="'modal-lg'">
	<div class="app-modal-header">
		<h4 class="modal-title strong">Update Order</h4>
		<button type="button" class="close basic-close-light-box"
			(click)="UrsCodeOrderModal.hide();">
			<span aria-hidden="true">&times;</span>
		</button>
	</div>
	<div class="app-modal-body" style="height: 500px; overflow-y: scroll;">
		<div>
			<div class="panel panel-default" dnd-sortable-container [sortableData]="this.unPublishedListForOrder"
				droppable>
				<div class="panel-heading"><strong>
						<div class="row">
							<div class="col-sm-2"></div>
							<div class="col-sm-4"> Urs Code</div>
							<div class="col-sm-4"> Requirement</div>
							<div class="col-sm-2">Order</div>
						</div>
					</strong>
				</div>
				<div class="panel-body">
					<ng-container *ngFor="let json of this.unPublishedListForOrder; let i = index;">
						<li [draggable] dnd-sortable [sortableIndex]="i"
							(onDragSuccess)="orderList(this.unPublishedListForOrder)" [dragData]="json"
							class="list-group-item">
							<div class="row">
								<div class="col-sm-2"> <a *ngIf="i!=0" container="body" placement="top"
										triggers="mouseenter:mouseleave" ngbTooltip="Move Up"
										(click)="moveUpOrDown(this.unPublishedListForOrder,i,true)">
										<i class="icofont icofont-arrow-up "></i>
									</a>
									<a *ngIf="i!=(this.unPublishedListForOrder.length-1)" container="body"
										placement="top" triggers="mouseenter:mouseleave" ngbTooltip="Move Down"
										(click)="moveUpOrDown(this.unPublishedListForOrder,i,false);">
										<i class="icofont icofont-arrow-down "></i>
									</a>
								</div>
								<div class="col-sm-4"> {{json.ursCode}}</div>
								<div class="col-sm-4"> {{json.ursName}}</div>
								<div class="col-sm-2"> {{json.order}}</div>
							</div>

						</li>
					</ng-container>
				</div>
			</div>
		</div>
		<br>
		<div class="form-group row">
			<div class="col-sm-12 text-center">
				<button *ngIf="this.unPublishedListForOrder.length > 0" type="button" class="btn btn-sm btn-success waves-effect waves-light m-r-10"
					(click)="updateOrder();">Save
				</button>
				<button type="button" class="btn btn-sm btn-danger waves-effect waves-light m-r-10"
					(click)="UrsCodeOrderModal.hide();this.loadData()">Cancel
				</button>
			</div>
		</div>
	</div>
</app-modal-basic>

<app-compliance-assesment-modal #complianceAssesmentModal [selectedList]="this.modal.complianceRequirements" (onSubmit)="onSubmitComplianceAssesment($event)"></app-compliance-assesment-modal>